<!DOCTYPE html>
<!-- saved from url=(0078)file:///C:/Users/kjy99/Desktop/%EC%83%88%20%ED%8F%B4%EB%8D%94%20(2)/index.html -->
<html lang="ko"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="청도중앙초등학교 세시풍속 대화형 질문답변 시스템 - 전통 명절과 세시풍속에 대해 질문하고 답변을 받아보세요">
    <meta name="keywords" content="세시풍속, 전통명절, 설날, 추석, 단오, 정월대보름, 동지, 전통놀이, 전통음식">
    <!-- PWA 메타 태그 -->
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="세시풍속 질문답변">
    
    <!-- 파비콘 -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; viewBox=&#39;0 0 100 100&#39;%3E%3Ctext y=&#39;.9em&#39; font-size=&#39;90&#39;%3E%F0%9F%8F%AE%3C/text%3E%3C/svg%3E">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* 브라우저 호환성을 위한 기본 스타일 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
        }

        body {
            font-family: 'Noto Sans KR', 'Malgun Gothic', '맑은 고딕', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-attachment: fixed;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(255, 255, 255, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 
                0 20px 40px rgba(0,0,0,0.1),
                0 0 0 1px rgba(255, 255, 255, 0.2);
            overflow: hidden;
            position: relative;
        }
        
        /* backdrop-filter 지원 브라우저용 */
        @supports (backdrop-filter: blur(10px)) {
            .container {
                backdrop-filter: blur(10px);
            }
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, 
                #ff9a9e 0%, 
                #fecfef 25%, 
                #667eea 50%, 
                #764ba2 75%, 
                #ff9a9e 100%);
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        .header {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            padding: 25px 80px 25px 25px;
            text-align: center;
            color: #333;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.8;
        }

        .subtitle {
            font-size: 0.9em !important;
            opacity: 0.7 !important;
            margin-top: 8px !important;
            font-style: italic;
        }

        .chat-container {
            padding: 30px;
            min-height: 400px;
        }

        .chat-messages {
            height: 400px;
            border: 2px solid #f0f0f0;
            border-radius: 15px;
            padding: 20px;
            overflow-y: auto;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            scroll-behavior: smooth;
        }

        .message {
            margin: 15px 0;
            padding: 15px 20px;
            border-radius: 15px;
            position: relative;
            animation: fadeInUp 0.3s ease-out;
            word-wrap: break-word;
            word-break: break-all;
            overflow-wrap: break-word;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .user-message {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: right;
            margin-left: 60px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .bot-message {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            color: #333;
            text-align: left;
            margin-right: 60px;
            box-shadow: 0 4px 15px rgba(255, 154, 158, 0.3);
        }

        .input-container {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .question-input {
            flex: 1;
            padding: 18px 25px;
            border: 2px solid #e0e0e0;
            border-radius: 30px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            -webkit-border-radius: 30px;
            -moz-border-radius: 30px;
        }

        .question-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
            -webkit-transform: translateY(-2px);
            -moz-transform: translateY(-2px);
        }

        .ask-button {
            padding: 18px 35px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            -webkit-border-radius: 30px;
            -moz-border-radius: 30px;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .ask-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
            -webkit-transform: translateY(-2px);
            -moz-transform: translateY(-2px);
        }

        .ask-button:active {
            transform: translateY(0);
            -webkit-transform: translateY(0);
            -moz-transform: translateY(0);
        }

        /* 관리자 메뉴 스타일 */
        .admin-menu-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .admin-menu-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .admin-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 20px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease;
            z-index: 1001;
            overflow-y: auto;
        }

        .admin-panel.active {
            right: 0;
        }

        .admin-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .close-admin {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .admin-content {
            padding: 20px;
        }

        .admin-section {
            margin-bottom: 30px;
        }

        .admin-section h3 {
            color: #333;
            margin-bottom: 15px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .question-log {
            max-height: 300px;
            overflow-y: auto;
        }

        .question-item {
            background: #f8f9fa;
            padding: 10px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .question-user {
            font-weight: bold;
            color: #667eea;
            font-size: 12px;
        }

        .question-text {
            margin: 5px 0;
            font-size: 14px;
        }

        .question-time {
            font-size: 11px;
            color: #666;
        }

        /* 모달 스타일 */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        /* backdrop-filter 지원 브라우저용 */
        @supports (backdrop-filter: blur(5px)) {
            .modal-overlay {
                backdrop-filter: blur(5px);
            }
        }

        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 0;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .modal-footer {
            padding: 20px 30px;
            text-align: right;
            border-top: 1px solid #eee;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
            margin-right: 10px;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
            margin-right: 10px;
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }

        .close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .message a {
            color: #667eea;
            text-decoration: underline;
            word-break: break-all;
            overflow-wrap: break-word;
        }

        .message a:hover {
            color: #5a6fd8;
            text-decoration: none;
        }

        /* 반응형 디자인 */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                margin: 0;
                border-radius: 15px;
            }

            .header {
                padding: 20px 60px 20px 20px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .admin-menu-toggle {
                width: 45px;
                height: 45px;
                top: 15px;
                right: 15px;
            }

            .admin-panel {
                width: 100%;
                right: -100%;
            }

            .user-message, .bot-message {
                margin-left: 15px;
                margin-right: 15px;
                padding: 15px;
            }

            .question-input {
                font-size: 16px; /* iOS 줌 방지 */
                padding: 15px;
            }

            .send-button {
                padding: 15px 20px;
            }

            .chat-messages {
                height: 300px;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5em;
            }
            
            .user-message, .bot-message {
                margin-left: 10px;
                margin-right: 10px;
                padding: 12px;
            }
            
            .question-input {
                padding: 12px;
            }
            
            .send-button {
                padding: 12px 16px;
            }
        }

        /* 로딩 애니메이션 */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .welcome-message {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .welcome-message h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .welcome-message p {
            color: #666;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 헤더 -->
        <div class="header">
            <h1>🏫 지뭉반 세시풍속 선생님</h1>
            <p>지뭉반 친구들과 함께 배우는 우리나라 세시풍속!</p>
            <p class="subtitle">우리 조상들의 지혜가 담긴 전통문화를 재미있게 배워보세요</p>
        </div>

        <!-- 관리자 메뉴 토글 버튼 -->
        <button class="admin-menu-toggle" onclick="showAdminLogin()" title="관리자 메뉴">
            ⚙️
        </button>

        <!-- 채팅 컨테이너 -->
        <div class="chat-container">
            <!-- 환영 메시지는 닉네임 입력 후에만 표시됩니다 -->

            <!-- 채팅 메시지 영역 -->
            <div class="chat-messages" id="chatMessages">
                <!-- 인사말은 닉네임 입력 후에만 표시됩니다 -->
            </div>

            <!-- 입력 영역 -->
            <div class="input-container">
                <input type="text" class="question-input" id="questionInput" placeholder="세시풍속에 대해 질문해보세요... (예: 부럼이 무엇인가요?)" autocomplete="off" spellcheck="false" autocapitalize="off">
                <button class="ask-button" onclick="askQuestion()">질문하기</button>
            </div>
        </div>
    </div>

    <!-- 관리자 패널 -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <h2>📊 관리자 패널</h2>
            <button class="close-admin" onclick="toggleAdminMenu()">×</button>
        </div>
        <div class="admin-content">
            <div class="admin-section">
                <h3>📈 실시간 통계</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-number" id="totalQuestions">66</div>
                        <div>총 질문 수</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="todayQuestions">66</div>
                        <div>오늘 질문</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="activeUsers">3</div>
                        <div>활성 사용자</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="popularTopics">6</div>
                        <div>인기 주제</div>
                    </div>
                </div>
            </div>

            <div class="admin-section">
                <h3>📝 최근 질문 로그</h3>
                <div class="question-log" id="questionLog">
                <div class="question-item">
                    <div class="question-user">d</div>
                    <div class="question-text">단오에는 무슨 놀이를 하나요</div>
                    <div class="question-time">2025. 10. 19. 오후 11:22:00</div>
                </div>
            
                <div class="question-item">
                    <div class="question-user">d</div>
                    <div class="question-text">단오에 무슨 놀이 하나요</div>
                    <div class="question-time">2025. 10. 19. 오후 11:21:55</div>
                </div>
            
                <div class="question-item">
                    <div class="question-user">d</div>
                    <div class="question-text">단오에 무슨 놀이 하나요</div>
                    <div class="question-time">2025. 10. 19. 오후 11:21:46</div>
                </div>
            
                <div class="question-item">
                    <div class="question-user">d</div>
                    <div class="question-text">단오에 무슨 놀이 해</div>
                    <div class="question-time">2025. 10. 19. 오후 11:21:39</div>
                </div>
            
                <div class="question-item">
                    <div class="question-user">d</div>
                    <div class="question-text">단오에 머해</div>
                    <div class="question-time">2025. 10. 19. 오후 11:21:29</div>
                </div>
            
                <div class="question-item">
                    <div class="question-user">d</div>
                    <div class="question-text">설날이 머야</div>
                    <div class="question-time">2025. 10. 19. 오후 11:21:15</div>
                </div>
            
                <div class="question-item">
                    <div class="question-user">d</div>
                    <div class="question-text">단오 음식은 뭐야</div>
                    <div class="question-time">2025. 10. 19. 오후 11:10:35</div>
                </div>
            
                <div class="question-item">
                    <div class="question-user">ㅇ</div>
                    <div class="question-text">단오 음식은 뭐야</div>
                    <div class="question-time">2025. 10. 19. 오후 9:49:26</div>
                </div>
            
                <div class="question-item">
                    <div class="question-user">ㅇ</div>
                    <div class="question-text">단오에 하는 일은 무어ㅑ</div>
                    <div class="question-time">2025. 10. 19. 오후 9:49:18</div>
                </div>
            
                <div class="question-item">
                    <div class="question-user">d</div>
                    <div class="question-text">단오에 뭐먹어</div>
                    <div class="question-time">2025. 10. 19. 오후 9:47:18</div>
                </div>
            </div>
            </div>

            <div class="admin-section">
                <h3>🔥 인기 질문</h3>
                <div class="popular-questions" id="popularQuestions">
                <div class="question-item">
                    <div class="question-text">지신이 뭐야</div>
                    <div class="question-time">10회 질문</div>
                </div>
            
                <div class="question-item">
                    <div class="question-text">설날에 뭐 먹어</div>
                    <div class="question-time">3회 질문</div>
                </div>
            
                <div class="question-item">
                    <div class="question-text">설날에 뭐먹어</div>
                    <div class="question-time">3회 질문</div>
                </div>
            
                <div class="question-item">
                    <div class="question-text">지신밟기를 왜해</div>
                    <div class="question-time">3회 질문</div>
                </div>
            
                <div class="question-item">
                    <div class="question-text">단오 음식은 뭐야</div>
                    <div class="question-time">3회 질문</div>
                </div>
            </div>
            </div>

            <div class="admin-section">
                <h3>🔍 키워드 분석</h3>
                <div class="keyword-analysis" id="keywordAnalysis">
                <div class="question-item">
                    <div class="question-text">단오</div>
                    <div class="question-time">15회 언급</div>
                </div>
            
                <div class="question-item">
                    <div class="question-text">설날</div>
                    <div class="question-time">15회 언급</div>
                </div>
            
                <div class="question-item">
                    <div class="question-text">음식</div>
                    <div class="question-time">7회 언급</div>
                </div>
            
                <div class="question-item">
                    <div class="question-text">동지</div>
                    <div class="question-time">7회 언급</div>
                </div>
            
                <div class="question-item">
                    <div class="question-text">놀이</div>
                    <div class="question-time">6회 언급</div>
                </div>
            
                <div class="question-item">
                    <div class="question-text">추석</div>
                    <div class="question-time">5회 언급</div>
                </div>
            
                <div class="question-item">
                    <div class="question-text">지신밟기</div>
                    <div class="question-time">5회 언급</div>
                </div>
            
                <div class="question-item">
                    <div class="question-text">왜</div>
                    <div class="question-time">5회 언급</div>
                </div>
            
                <div class="question-item">
                    <div class="question-text">정월대보름</div>
                    <div class="question-time">3회 언급</div>
                </div>
            
                <div class="question-item">
                    <div class="question-text">대보름</div>
                    <div class="question-time">3회 언급</div>
                </div>
            </div>
            </div>

            <div class="admin-actions">
                <button class="btn btn-primary" onclick="exportData()">📤 데이터 내보내기</button>
                <button class="btn btn-secondary" onclick="clearOldData()">🗑️ 오래된 데이터 삭제</button>
                <button class="btn btn-danger" onclick="clearAllQuestionHistory()">🧹 모든 질문 기록 삭제</button>
                <button class="btn btn-secondary" onclick="refreshStats()">🔄 통계 새로고침</button>
            </div>
        </div>
    </div>

    <!-- 닉네임 입력 모달 -->
    <div class="modal" id="nicknameModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>👋 청도중앙초등학교에 오신 것을 환영합니다!</h2>
                <button class="close" onclick="closeNicknameModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="nicknameInput">닉네임을 입력해주세요:</label>
                    <input type="text" id="nicknameInput" placeholder="지뭉반 1번" maxlength="20">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="saveNickname()">시작하기</button>
            </div>
        </div>
    </div>

    <!-- 관리자 로그인 모달 -->
    <div class="modal" id="adminLoginModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>🔐 관리자 로그인</h2>
                <button class="close" onclick="closeAdminLoginModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="adminPasswordInput">비밀번호를 입력해주세요:</label>
                    <input type="password" id="adminPasswordInput" placeholder="비밀번호 입력">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="checkAdminPassword()">로그인</button>
                <button class="btn btn-secondary" onclick="closeAdminLoginModal()">취소</button>
            </div>
        </div>
    </div>

    <script>
        // 전역 변수
        let currentUser = null;
        const ADMIN_PASSWORD = "1234";
        let adminData = {
            questions: [],
            users: new Set(),
            keywords: {},
            categories: {}
        };

        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', function() {
            try {
                console.log('✅ 페이지 로드 완료!');
                
                // 매번 닉네임 입력 모달 표시
                showNicknameModal();
                
                // 관리자 데이터 로드
                loadAdminData();
                
                // 엔터 키 이벤트 리스너
                const questionInput = document.getElementById('questionInput');
                if (questionInput) {
                    questionInput.addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') {
                            askQuestion();
                        }
                    });
                }
                
                // 모달 외부 클릭 시 닫기
                window.addEventListener('click', function(e) {
                    if (e.target.classList.contains('modal')) {
                        closeNicknameModal();
                        closeAdminLoginModal();
                    }
                });
                
            } catch (error) {
                console.error('❌ 페이지 초기화 중 오류 발생:', error);
                alert('페이지 로드 중 오류가 발생했습니다. 페이지를 새로고침해주세요.');
            }
        });

        // 닉네임 모달 관련 함수들
        function showNicknameModal() {
            document.getElementById('nicknameModal').style.display = 'block';
            document.getElementById('nicknameInput').focus();
        }

        function closeNicknameModal() {
            document.getElementById('nicknameModal').style.display = 'none';
        }

        function saveNickname() {
            const nickname = document.getElementById('nicknameInput').value.trim();
            if (!nickname) {
                alert('닉네임을 입력해주세요!');
                return;
            }
            
            currentUser = {
                nickname: nickname,
                loginTime: new Date().toISOString()
            };
            
            closeNicknameModal();
            
            // 환영 메시지 표시
            addMessage('bot', `안녕하세요, ${nickname}님! 저는 여러분의 세시풍속 선생님이에요. 우리나라의 재미있는 전통 문화에 대해 쉽고 재미있게 알려드릴게요. 궁금한 것이 있으면 편하게 질문해주세요! 😊`);
        }

        // 관리자 관련 함수들
        function showAdminLogin() {
            document.getElementById('adminLoginModal').style.display = 'block';
            document.getElementById('adminPasswordInput').focus();
        }

        function closeAdminLoginModal() {
            document.getElementById('adminLoginModal').style.display = 'none';
            document.getElementById('adminPasswordInput').value = '';
        }

        function checkAdminPassword() {
            const password = document.getElementById('adminPasswordInput').value;
            if (password === ADMIN_PASSWORD) {
                closeAdminLoginModal();
                toggleAdminMenu();
                loadAdminData();
            } else {
                alert('비밀번호가 올바르지 않습니다!');
            }
        }

        function toggleAdminMenu() {
            const panel = document.getElementById('adminPanel');
            panel.classList.toggle('active');
        }

        // 질문 처리 함수
        function askQuestion() {
            const input = document.getElementById('questionInput');
            const question = input.value.trim();
            
            if (!question) {
                alert('질문을 입력해주세요!');
                return;
            }
            
            if (!currentUser) {
                alert('먼저 닉네임을 입력해주세요!');
                showNicknameModal();
                return;
            }
            
            // 사용자 메시지 표시
            addMessage('user', question);
            input.value = '';
            
            // 로딩 표시
            const loadingDiv = addMessage('bot', '<span class="loading"></span> 답변을 생성하고 있습니다...');
            
            // 답변 생성 (비동기)
            setTimeout(() => {
                const answer = findAnswer(question);
                
                // 로딩 메시지 제거
                const messages = document.getElementById('chatMessages');
                messages.removeChild(loadingDiv);
                
                // 실제 답변 표시
                addMessage('bot', answer);
                
                // 관리자 데이터에 기록
                logQuestion(question, answer);
            }, 1000);
        }

        // 메시지 추가 함수
        function addMessage(type, content) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}-message`;
            
            if (type === 'user') {
                messageDiv.innerHTML = `<strong>${currentUser.nickname}:</strong> ${content}`;
            } else {
                // URL을 클릭 가능한 링크로 변환
                const linkContent = content.replace(/https:\/\/[^\s]+/g, '<a href="$&" target="_blank">$&</a>');
                messageDiv.innerHTML = `<strong>🏫 세시풍속 선생님:</strong> ${linkContent}`;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            return messageDiv;
        }

        // 포괄적인 세시풍속 데이터베이스 (청도 지역 특화)
        const sesiData = {
            // 청도 지역 특화 정보
            cheongdo: {
                name: "경북 청도",
                description: "청도는 경상북도에 위치한 전통문화가 풍부한 지역입니다.",
                specialFestivals: {
                    "청도달집태우기": {
                        date: "정월대보름",
                        description: "전국 최대 규모의 달집태우기 행사",
                        location: "청도읍성 일대",
                        participants: "약 2만명의 시민 참여",
                        meaning: "한 해의 액운을 막고 복을 기원하는 전통 행사",
                        details: "솔가지와 볏단을 쌓아 올린 거대한 달집에 불을 붙여 액운을 날리고 새해의 풍요를 기원합니다.",
                        visualElements: ["달집", "불꽃", "시민들", "청도읍성"]
                    }
                },
                culturalHeritage: {
                    "청도읍성": {
                        description: "고려시대부터 존재한 읍성으로 겨울철 야경 명소",
                        significance: "정월대보름 등 전통 행사가 열리는 장소",
                        history: "조선시대 선조 연간에 현재 규모로 완성"
                    },
                    "대비사대웅전": {
                        description: "조선시대에 건립된 사찰",
                        significance: "지역의 역사와 문화를 엿볼 수 있는 장소"
                    }
                }
            },
            // 봄편 세시풍속
            spring: {
                name: "봄편",
                festivals: {
                    "정월대보름": {
                        date: "음력 1월 15일",
                        description: "정월의 첫 보름달을 맞이하는 날",
                        foods: ["오곡밥", "부럼", "귀밝이술", "나물", "오색나물", "약밥"],
                        activities: ["달맞이", "지신밟기", "쥐불놀이", "줄다리기", "나무심기", "복조리만들기", "달집태우기"],
                        meaning: "새해의 풍년과 건강을 기원하는 날",
                        origin: "농경사회에서 풍년을 기원하고 액운을 쫓는 의미로 시작",
                        details: "보름달을 보며 소원을 빌고, 다섯 가지 나물을 먹어 건강을 기원합니다.",
                        cheongdoSpecial: {
                            event: "청도달집태우기",
                            description: "전국 최대 규모의 달집태우기 행사가 청도읍성에서 열립니다",
                            participants: "약 2만명의 시민이 참여",
                            significance: "청도 지역의 대표적인 정월대보름 행사"
                        }
                    },
                    "한식": {
                        date: "음력 2월 15일경",
                        description: "조상의 묘에 성묘하는 날",
                        foods: ["차례상", "제사음식", "한과", "약과", "다식"],
                        activities: ["성묘", "벌초", "차례", "제사", "묘지정리"],
                        meaning: "조상에 대한 추모와 효심을 표현하는 날",
                        origin: "유교 사상에서 조상숭배의 의미로 시작된 풍습",
                        details: "조상의 묘에 찾아가 제사를 지내고 묘지를 정리하는 효심의 표현입니다."
                    },
                    "삼짇날": {
                        date: "음력 3월 3일",
                        description: "봄의 화사함을 즐기는 날",
                        foods: ["화전", "국화전", "화채", "진달래화전", "복숭아화전"],
                        activities: ["화전놀이", "산놀이", "물놀이", "화구경", "봄나들이"],
                        meaning: "봄의 아름다움을 감상하고 즐기는 날",
                        origin: "중국의 상사절에서 유래하여 우리나라의 봄 축제로 발전",
                        details: "봄꽃을 감상하고 화전을 만들어 먹으며 봄의 기쁨을 만끽하는 날입니다."
                    },
                    "청명": {
                        date: "음력 3월 상순",
                        description: "하늘이 맑고 밝은 날",
                        foods: ["청명절식", "나물", "한과"],
                        activities: ["성묘", "벌초", "산나들이", "등고"],
                        meaning: "조상에게 인사하고 봄의 기운을 느끼는 날",
                        origin: "24절기 중 하나로 조상숭배와 자연과의 조화를 의미",
                        details: "하늘이 맑아지는 시기에 조상의 묘에 인사하고 봄의 신선한 기운을 느낍니다."
                    },
                    "한식": {
                        date: "음력 4월 5일경",
                        description: "불을 끄고 찬 음식을 먹는 날",
                        foods: ["한과", "약과", "다식", "엿", "찬 음식"],
                        activities: ["한식제", "불끄기", "차례", "제사"],
                        meaning: "조상에 대한 추모와 효심을 표현하는 날",
                        origin: "중국 진문공의 개자추 이야기에서 유래된 풍습",
                        details: "불을 끄고 찬 음식만 먹으며 조상을 추모하는 의미의 날입니다."
                    }
                }
            },
            
            // 여름편 세시풍속
            summer: {
                name: "여름편",
                festivals: {
                    "단오": {
                        date: "음력 5월 5일",
                        description: "여름의 대표적인 명절",
                        foods: ["수리취떡", "창포주", "단오주", "제호탕", "단오떡", "창포떡"],
                        activities: ["창포물 머리감기", "그네뛰기", "씨름", "활쏘기"],
                        meaning: "여름의 시작과 건강, 액운을 쫓는 날",
                        origin: "중국에서 전래된 명절로, 우리나라에서는 여름의 대표적인 명절로 발전",
                        details: "창포로 머리를 감고 수리취떡을 먹으며 여름의 건강과 액운을 쫓는 의미입니다."
                    },
                    "유두": {
                        date: "음력 6월 15일",
                        description: "여름 더위를 이기는 날",
                        foods: ["유두면", "수박", "오이", "참외", "복숭아", "포도"],
                        activities: ["등고", "물놀이", "폭포놀이", "계곡놀이"],
                        meaning: "여름 더위를 이기고 건강을 기원하는 날",
                        origin: "여름의 더위를 이기기 위한 풍습에서 시작",
                        details: "시원한 과일과 물놀이로 여름 더위를 이기며 건강을 기원하는 날입니다."
                    },
                    "칠석": {
                        date: "음력 7월 7일",
                        description: "견우와 직녀가 만나는 날",
                        foods: ["칠석과일", "밀국수", "과일", "달떡"],
                        activities: ["칠석제", "별바라기", "바느질"],
                        meaning: "견우직녀의 전설을 기리는 로맨틱한 날",
                        origin: "중국 전설에서 유래된 견우와 직녀의 만남을 기리는 날",
                        details: "견우와 직녀가 일 년에 한 번 만나는 날로, 별을 바라보며 소원을 빕니다."
                    },
                    "백중": {
                        date: "음력 7월 15일",
                        description: "부처님의 귀환을 기리는 날",
                        foods: ["백중떡", "과일", "백중음식"],
                        activities: ["백중제", "백중굿", "머슴놀이"],
                        meaning: "부처님의 귀환과 중원의 풍요를 기원하는 날",
                        origin: "불교에서 유래된 풍습으로 중원의 풍요를 기원",
                        details: "부처님이 지옥에서 돌아오는 날로, 중원의 풍요와 행복을 기원합니다."
                    }
                }
            },
            
            // 가을편 세시풍속
            autumn: {
                name: "가을편",
                festivals: {
                    "추석": {
                        date: "음력 8월 15일",
                        description: "가을의 대표적인 명절, 한가위",
                        foods: ["송편", "토란국", "나물", "과일", "한과", "약과"],
                        activities: ["강강술래", "소놀이", "줄다리기", "성묘", "차례"],
                        meaning: "가을 수확을 감사하고 조상에게 감사하는 날",
                        origin: "농경사회에서 추수를 감사하는 의미로 시작된 명절",
                        details: "가을 수확의 기쁨을 조상과 나누고, 온 가족이 함께 모여 화합하는 명절입니다."
                    },
                    "중양절": {
                        date: "음력 9월 9일",
                        description: "국화를 감상하는 날",
                        foods: ["국화전", "국화주", "국화차", "중양절음식"],
                        activities: ["등고", "국화구경", "국화전 만들기"],
                        meaning: "국화의 아름다움을 감상하고 건강을 기원하는 날",
                        origin: "중국의 중양절에서 유래된 풍습으로 국화를 감상하는 날",
                        details: "국화가 만발한 시기에 산에 올라 국화를 감상하며 건강과 장수를 기원합니다."
                    },
                    "상달고사": {
                        date: "음력 10월",
                        description: "가을 수확 후 고사를 지내는 시기",
                        foods: ["고사음식", "새곡식", "수확음식"],
                        activities: ["고사지내기", "수확감사", "고사놀이"],
                        meaning: "가을 수확에 대한 감사와 내년 풍년 기원",
                        origin: "농경사회에서 수확 후 토지신에게 감사하는 풍습",
                        details: "가을 수확을 마친 후 토지신과 조상에게 감사하며 내년 풍년을 기원합니다."
                    },
                    "상달": {
                        date: "음력 10월",
                        description: "가을의 마지막 달",
                        foods: ["상달음식", "김치", "장"],
                        activities: ["김장", "장담그기", "겨울준비"],
                        meaning: "겨울을 준비하고 한 해를 마무리하는 시기",
                        origin: "농경사회에서 겨울 준비를 위한 풍습",
                        details: "겨울을 대비해 김치를 담그고 장을 담그며 한 해를 마무리합니다."
                    }
                }
            },
            
            // 겨울편 세시풍속
            winter: {
                name: "겨울편",
                festivals: {
                    "설날": {
                        date: "음력 1월 1일",
                        description: "새해의 첫날, 우리나라 최대 명절",
                        foods: ["떡국", "전", "나물", "과일", "한과", "약과", "다식"],
                        activities: ["세배", "차례", "윷놀이", "연날리기", "널뛰기", "제기차기"],
                        meaning: "새해의 시작과 가족의 화합을 다지는 날",
                        origin: "농경사회에서 새해의 시작을 기념하는 의미로 시작",
                        details: "새해의 첫날로 온 가족이 모여 화합하고 새해의 복을 기원하는 가장 중요한 명절입니다."
                    },
                    "동지": {
                        date: "음력 11월 하순",
                        description: "일년 중 밤이 가장 긴 날",
                        foods: ["팥죽", "동지떡", "동지음식"],
                        activities: ["팥죽먹기", "동지제"],
                        meaning: "긴 밤을 지내고 낮이 길어지는 것을 기념하는 날",
                        origin: "24절기 중 하나로 일년 중 밤이 가장 긴 날",
                        details: "일년 중 밤이 가장 긴 날로, 팥죽을 먹으며 액운을 쫓고 낮이 길어지는 것을 기념합니다."
                    },
                    "납월": {
                        date: "음력 12월",
                        description: "한 해를 마무리하는 달",
                        foods: ["김치", "젓갈", "장", "납월음식"],
                        activities: ["김장", "제수준비", "대청소", "겨울준비"],
                        meaning: "겨울을 준비하고 새해를 맞이하는 준비의 시간",
                        origin: "농경사회에서 겨울 준비와 새해 준비를 위한 풍습",
                        details: "한 해를 마무리하고 새해를 준비하는 달로, 김장과 대청소로 새해를 맞이합니다."
                    },
                    "섣달그믐": {
                        date: "음력 12월 마지막 날",
                        description: "한 해의 마지막 날",
                        foods: ["섣달음식", "제수", "한과"],
                        activities: ["제수준비", "대청소", "새해준비"],
                        meaning: "한 해를 마무리하고 새해를 준비하는 날",
                        origin: "새해를 맞이하기 위한 준비의 의미",
                        details: "한 해의 마지막 날로, 제수를 준비하고 집안을 깨끗이 하여 새해를 맞이합니다."
                    }
                }
            },
            
            // 전통 놀이
            games: {
                "강강술래": {
                    description: "추석 밤에 여성들이 손을 맞잡고 원을 그리며 노래하고 춤추는 전통 민속놀이",
                    meaning: "농사의 풍년을 기원하고 공동체의 화합을 도모",
                    status: "유네스코 인류무형문화유산",
                    details: "여성들이 손을 맞잡고 원을 그리며 노래하고 춤추는 놀이로, 농사의 풍년을 기원합니다."
                },
                "윷놀이": {
                    description: "작은 나무를 쪼개어 4개로 만든 윷을 던져서 윷판의 말을 이동시켜 승부를 겨루는 민속놀이",
                    meaning: "가족 간의 화합과 재미를 위한 놀이로, 이기는 편에 풍년이 든다고 믿었습니다",
                    status: "설날부터 대보름까지 하는 대표 놀이",
                    details: "4개의 윷을 던져 나온 결과(도, 개, 걸, 윷, 모)에 따라 말을 이동시키는 놀이입니다. 윷이나 모가 나올 때는 한 번 더 던질 수 있어서 더 멀리 이동할 수 있습니다. 남자, 여자, 노인, 아이 누구나 함께 즐길 수 있고 어디에서나 할 수 있는 놀이입니다."
                },
                "연날리기": {
                    description: "연을 만들어 하늘에 띄우는 놀이",
                    meaning: "나쁜 기운을 날려보내고 좋은 기운을 받는 의미",
                    status: "설날과 단오의 전통 놀이",
                    details: "종이로 만든 연을 하늘에 띄워 나쁜 기운을 날려보냅니다."
                },
                "그네뛰기": {
                    description: "그네에 올라가서 앞뒤로 흔들리는 놀이",
                    meaning: "여성들의 건강과 아름다움을 기원",
                    status: "단오의 대표 놀이",
                    details: "높은 나무에 그네를 매달고 앞뒤로 흔들리는 놀이입니다."
                },
                "씨름": {
                    description: "두 사람이 서로 맞잡고 상대방을 넘어뜨리는 놀이",
                    meaning: "남성들의 힘과 용맹함을 겨루는 놀이",
                    status: "단오의 대표 놀이",
                    details: "두 사람이 서로 맞잡고 상대방을 넘어뜨리는 힘겨루기 놀이입니다."
                },
                "널뛰기": {
                    description: "널판을 밟아서 뛰는 놀이",
                    meaning: "여성들의 건강과 키가 크기를 기원",
                    status: "설날의 전통 놀이",
                    details: "널판을 밟아서 뛰는 놀이로, 키가 크고 건강해지기를 기원합니다."
                },
                "제기차기": {
                    description: "제기를 발로 차는 놀이",
                    meaning: "재치와 민첩함을 기르는 놀이",
                    status: "설날과 단오의 놀이",
                    details: "제기를 발로 차서 떨어뜨리지 않도록 하는 놀이입니다."
                },
                "팽이치기": {
                    description: "팽이를 회전시키는 놀이",
                    meaning: "집중력과 인내심을 기르는 놀이",
                    status: "겨울철 놀이",
                    details: "팽이를 회전시켜 오래 돌리는 놀이입니다."
                },
                "활쏘기": {
                    description: "활로 과녁을 쏘는 놀이",
                    meaning: "집중력과 정확성을 기르는 놀이",
                    status: "단오의 놀이",
                    details: "활로 과녁을 정확히 쏘는 놀이입니다."
                },
                "줄다리기": {
                    description: "두 팀이 줄을 당겨 승부를 겨루는 놀이",
                    meaning: "팀워크와 협동심을 기르는 놀이",
                    status: "정월대보름과 추석의 놀이",
                    details: "두 팀이 긴 줄을 당겨 승부를 겨루는 놀이입니다."
                }
            },
            
            // 전통 음식
            foods: {
                "떡국": {
                    description: "설날에 먹는 전통 음식",
                    meaning: "흰 떡국은 곡식의 정수로 풍년과 건강을 기원하며, 긴 떡국은 장수를 상징",
                    ingredients: ["떡", "국물", "고명", "소고기", "파"],
                    details: "설날 아침에 먹는 대표 음식으로, 한 살 더 먹는다는 의미가 있습니다."
                },
                "송편": {
                    description: "추석에 빚는 전통 떡",
                    meaning: "보름달을 닮은 모양으로 풍요와 단결을 상징",
                    ingredients: ["쌀가루", "팥", "참깨", "콩", "소금"],
                    details: "반달 모양으로 빚어 만든 떡으로, 추석의 대표 음식입니다."
                },
                "수리취떡": {
                    description: "단오에 먹는 떡",
                    meaning: "수리취의 독특한 향으로 악귀를 쫓는 의미",
                    ingredients: ["수리취", "쌀가루", "팥", "소금"],
                    details: "수리취 잎을 넣어 만든 떡으로, 단오의 대표 음식입니다."
                },
                "팥죽": {
                    description: "동지에 먹는 전통 음식",
                    meaning: "팥의 빨간색이 악귀를 쫓는다고 믿어 동지에 먹음",
                    ingredients: ["팥", "쌀", "소금", "팥알"],
                    details: "동지날에 먹는 대표 음식으로, 액운을 쫓는다고 믿습니다."
                },
                "오곡밥": {
                    description: "정월대보름에 먹는 밥",
                    meaning: "다섯 가지 곡식으로 풍년을 기원",
                    ingredients: ["쌀", "보리", "콩", "팥", "수수"],
                    details: "다섯 가지 곡식을 섞어 지은 밥으로, 정월대보름의 대표 음식입니다."
                },
                "부럼": {
                    description: "정월대보름에 먹는 견과류",
                    meaning: "부스럼(피부가 빨갛게 되거나 부어오르는 증상)이 생기지 않도록 기원하는 의미",
                    ingredients: ["호두", "땅콩", "밤", "잣"],
                    details: "정월대보름 아침에 먹는 견과류로, 피부가 빨갛게 되거나 부어오르는 부스럼을 예방한다고 믿습니다."
                },
                "귀밝이술": {
                    description: "정월대보름에 마시는 술",
                    meaning: "한 해 동안 귀가 밝아지도록 기원",
                    ingredients: ["청주", "찹쌀", "누룩"],
                    details: "정월대보름에 마시는 술로, 귀가 밝아지기를 기원합니다."
                },
                "화전": {
                    description: "삼짇날에 먹는 떡",
                    meaning: "봄꽃의 아름다움을 음식으로 즐기는 의미",
                    ingredients: ["쌀가루", "진달래", "복숭아꽃", "소금"],
                    details: "봄꽃을 넣어 만든 떡으로, 삼짇날의 대표 음식입니다."
                },
                "국화전": {
                    description: "중양절에 먹는 전",
                    meaning: "국화의 아름다움과 건강을 기원",
                    ingredients: ["국화", "밀가루", "달걀", "소금"],
                    details: "국화를 넣어 만든 전으로, 중양절의 대표 음식입니다."
                },
                "한과": {
                    description: "전통 과자",
                    meaning: "달콤함으로 행복을 상징",
                    ingredients: ["밀가루", "꿀", "참기름", "계피"],
                    details: "전통적인 한국 과자로, 명절과 제사에 사용됩니다."
                },
                "약과": {
                    description: "기름에 튀긴 전통 과자",
                    meaning: "달콤함과 바삭함으로 기쁨을 상징",
                    ingredients: ["밀가루", "꿀", "기름", "계피"],
                    details: "기름에 튀겨 만든 전통 과자로, 명절에 즐겨 먹습니다."
                }
            },
            
            // 사진 자료 정보
            photoMaterials: {
                "달집태우기": {
                    description: "정월대보름 달집태우기 사진",
                    keywords: ["달집", "불꽃", "정월대보름", "전통행사", "시민참여"],
                    searchTerms: "달집태우기 정월대보름 전통행사",
                    visualElements: ["거대한 달집", "화려한 불꽃", "참여하는 시민들", "밤하늘", "축제 분위기"],
                    location: "청도읍성, 전국 각지",
                    season: "정월대보름"
                },
                "윷놀이": {
                    description: "가족이 함께 윷놀이를 하는 사진",
                    keywords: ["윷놀이", "가족", "설날", "전통놀이", "화목"],
                    searchTerms: "윷놀이 설날 가족 전통놀이",
                    visualElements: ["윷판", "윷", "말", "웃는 가족들", "한복"],
                    location: "집안, 마당",
                    season: "설날"
                },
                "강강술래": {
                    description: "추석 밤 강강술래를 추는 사진",
                    keywords: ["강강술래", "추석", "여성들", "원형춤", "유네스코"],
                    searchTerms: "강강술래 추석 원형춤 여성들",
                    visualElements: ["손잡은 여성들", "원형 형태", "한복", "보름달", "어둠"],
                    location: "마당, 넓은 공터",
                    season: "추석"
                },
                "그네뛰기": {
                    description: "단오날 그네뛰기를 하는 사진",
                    keywords: ["그네뛰기", "단오", "여성", "놀이", "하늘"],
                    searchTerms: "그네뛰기 단오 여성 놀이",
                    visualElements: ["높은 그네", "한복 입은 여성", "나무", "하늘", "바람"],
                    location: "높은 나무가 있는 마당",
                    season: "단오"
                },
                "송편빚기": {
                    description: "추석에 송편을 빚는 사진",
                    keywords: ["송편", "추석", "가족", "빚기", "전통음식"],
                    searchTerms: "송편 빚기 추석 가족 전통음식",
                    visualElements: ["송편", "쌀가루", "팥", "가족들", "반죽하는 손"],
                    location: "집안, 부엌",
                    season: "추석"
                },
                "떡국먹기": {
                    description: "설날 아침 떡국을 먹는 사진",
                    keywords: ["떡국", "설날", "아침", "가족", "전통음식"],
                    searchTerms: "떡국 설날 아침 가족 식사",
                    visualElements: ["떡국", "상", "한복 입은 가족들", "웃음", "따뜻한 분위기"],
                    location: "집안, 상",
                    season: "설날"
                },
                "연날리기": {
                    description: "설날에 연을 날리는 사진",
                    keywords: ["연날리기", "설날", "아이들", "하늘", "바람"],
                    searchTerms: "연날리기 설날 아이들 하늘",
                    visualElements: ["하늘을 나는 연", "아이들", "실", "바람", "밝은 하늘"],
                    location: "마당, 넓은 공터",
                    season: "설날"
                },
                "씨름": {
                    description: "단오날 씨름을 하는 사진",
                    keywords: ["씨름", "단오", "남성", "힘겨루기", "전통놀이"],
                    searchTerms: "씨름 단오 남성 힘겨루기",
                    visualElements: ["씨름하는 남성들", "모래판", "관중들", "흥미진진한 장면"],
                    location: "마당, 씨름판",
                    season: "단오"
                },
                "지신밟기": {
                    description: "정월대보름 지신밟기를 하는 사진",
                    keywords: ["지신밟기", "정월대보름", "집안", "액운", "전통풍습"],
                    searchTerms: "지신밟기 정월대보름 집안 액운",
                    visualElements: ["집안을 도는 사람들", "전통의상", "집 구조", "축복의 의미"],
                    location: "집안, 마당",
                    season: "정월대보름"
                },
                "오곡밥": {
                    description: "정월대보름 오곡밥을 먹는 사진",
                    keywords: ["오곡밥", "정월대보름", "다섯곡식", "건강", "전통음식"],
                    searchTerms: "오곡밥 정월대보름 다섯곡식 건강",
                    visualElements: ["다섯 가지 곡식", "밥그릇", "가족", "건강한 식사"],
                    location: "집안, 식탁",
                    season: "정월대보름"
                },
                "부럼": {
                    description: "정월대보름 부럼을 먹는 사진",
                    keywords: ["부럼", "정월대보름", "견과류", "건강", "전통음식"],
                    searchTerms: "부럼 정월대보름 견과류 건강",
                    visualElements: ["호두", "땅콩", "밤", "잣", "가족"],
                    location: "집안, 식탁",
                    season: "정월대보름"
                },
                "귀밝이술": {
                    description: "정월대보름 귀밝이술을 마시는 사진",
                    keywords: ["귀밝이술", "정월대보름", "전통술", "건강", "전통음식"],
                    searchTerms: "귀밝이술 정월대보름 전통술",
                    visualElements: ["술잔", "전통술", "가족", "건강한 마시기"],
                    location: "집안, 상",
                    season: "정월대보름"
                },
                "화전": {
                    description: "삼짇날 화전을 만드는 사진",
                    keywords: ["화전", "삼짇날", "봄꽃", "전통음식", "봄"],
                    searchTerms: "화전 삼짇날 봄꽃 전통음식",
                    visualElements: ["봄꽃", "쌀가루", "팬", "따뜻한 분위기"],
                    location: "부엌, 마당",
                    season: "삼짇날"
                },
                "수리취떡": {
                    description: "단오 수리취떡을 만드는 사진",
                    keywords: ["수리취떡", "단오", "전통떡", "수리취", "여름"],
                    searchTerms: "수리취떡 단오 전통떡 수리취",
                    visualElements: ["수리취", "떡", "쌀가루", "여름 음식"],
                    location: "부엌",
                    season: "단오"
                },
                "팥죽": {
                    description: "동지 팥죽을 먹는 사진",
                    keywords: ["팥죽", "동지", "전통음식", "겨울", "건강"],
                    searchTerms: "팥죽 동지 전통음식 겨울",
                    visualElements: ["팥", "죽", "그릇", "따뜻한 분위기"],
                    location: "집안, 상",
                    season: "동지"
                },
                "한과": {
                    description: "전통 한과를 만드는 사진",
                    keywords: ["한과", "전통과자", "달콤함", "명절", "전통음식"],
                    searchTerms: "한과 전통과자 명절 전통음식",
                    visualElements: ["한과", "밀가루", "꿀", "달콤한 과자"],
                    location: "부엌",
                    season: "명절"
                },
                "약과": {
                    description: "전통 약과를 만드는 사진",
                    keywords: ["약과", "전통과자", "튀김", "명절", "달콤함"],
                    searchTerms: "약과 전통과자 튀김 명절",
                    visualElements: ["약과", "기름", "튀김", "달콤한 과자"],
                    location: "부엌",
                    season: "명절"
                },
                "한복": {
                    description: "전통 한복을 입은 모습의 사진",
                    keywords: ["한복", "전통의상", "명절", "예쁜", "전통"],
                    searchTerms: "한복 전통의상 명절",
                    visualElements: ["한복", "전통의상", "아름다운 색상", "전통적 미"],
                    location: "명절 행사장, 집",
                    season: "명절"
                },
                "제기차기": {
                    description: "제기차기를 하는 사진",
                    keywords: ["제기차기", "전통놀이", "아이들", "재치", "민첩함"],
                    searchTerms: "제기차기 전통놀이 아이들",
                    visualElements: ["제기", "발", "아이들", "재치있는 모습"],
                    location: "마당, 공터",
                    season: "설날, 단오"
                },
                "팽이치기": {
                    description: "팽이치기를 하는 사진",
                    keywords: ["팽이치기", "팽이", "전통놀이", "집중력", "겨울"],
                    searchTerms: "팽이치기 팽이 전통놀이",
                    visualElements: ["팽이", "실", "회전", "아이들"],
                    location: "마당, 공터",
                    season: "겨울"
                },
                "널뛰기": {
                    description: "널뛰기를 하는 사진",
                    keywords: ["널뛰기", "전통놀이", "여성", "설날", "키크기"],
                    searchTerms: "널뛰기 전통놀이 여성 설날",
                    visualElements: ["널판", "여성", "뛰는 모습", "높이"],
                    location: "마당",
                    season: "설날"
                },
                "국화전": {
                    description: "중양절 국화전을 만드는 사진",
                    keywords: ["국화전", "중양절", "국화", "전", "가을"],
                    searchTerms: "국화전 중양절 국화 전",
                    visualElements: ["국화", "전", "가을", "아름다운 색상"],
                    location: "부엌",
                    season: "중양절"
                },
                "칠석과일": {
                    description: "칠석날 과일을 준비하는 사진",
                    keywords: ["칠석과일", "칠석", "과일", "견우직녀", "여름"],
                    searchTerms: "칠석과일 칠석 과일 견우직녀",
                    visualElements: ["과일", "여름과일", "아름다운 배치", "칠석"],
                    location: "집안, 상",
                    season: "칠석"
                },
                "백중떡": {
                    description: "백중떡을 만드는 사진",
                    keywords: ["백중떡", "백중", "떡", "여름", "전통음식"],
                    searchTerms: "백중떡 백중 떡 여름",
                    visualElements: ["백중떡", "떡", "여름 음식", "전통"],
                    location: "부엌",
                    season: "백중"
                },
                "상달고사": {
                    description: "상달고사를 지내는 사진",
                    keywords: ["상달고사", "고사", "가을", "수확", "감사"],
                    searchTerms: "상달고사 고사 가을 수확",
                    visualElements: ["고사상", "곡식", "감사", "가을"],
                    location: "마당, 집",
                    season: "상달"
                },
                "김장": {
                    description: "김장을 하는 사진",
                    keywords: ["김장", "김치", "겨울준비", "가족", "전통"],
                    searchTerms: "김장 김치 겨울준비 가족",
                    visualElements: ["배추", "김치", "가족", "겨울준비"],
                    location: "마당, 부엌",
                    season: "상달"
                },
                "차례": {
                    description: "차례를 지내는 사진",
                    keywords: ["차례", "제사", "조상", "명절", "전통"],
                    searchTerms: "차례 제사 조상 명절",
                    visualElements: ["차례상", "음식", "가족", "정성"],
                    location: "집안",
                    season: "명절"
                },
                "성묘": {
                    description: "성묘를 하는 사진",
                    keywords: ["성묘", "묘지", "조상", "한식", "추모"],
                    searchTerms: "성묘 묘지 조상 한식",
                    visualElements: ["묘지", "꽃", "조상", "추모"],
                    location: "묘지",
                    season: "한식, 추석"
                },
                "청명나들이": {
                    description: "청명날 봄나들이를 하는 사진",
                    keywords: ["청명", "봄나들이", "꽃구경", "봄"],
                    searchTerms: "청명 봄나들이 꽃구경",
                    visualElements: ["꽃", "봄나들이", "가족", "자연"],
                    location: "산, 공원",
                    season: "청명"
                },
                "유두목욕": {
                    description: "유두날 목욕을 하는 사진",
                    keywords: ["유두목욕", "유두", "목욕", "여름", "깨끗함"],
                    searchTerms: "유두목욕 유두 목욕 여름",
                    visualElements: ["물", "목욕", "여름", "깨끗함"],
                    location: "강, 바다",
                    season: "유두"
                },
                "칠석기원": {
                    description: "칠석날 기원을 하는 사진",
                    keywords: ["칠석기원", "칠석", "기원", "견우직녀", "사랑"],
                    searchTerms: "칠석기원 칠석 기원 견우직녀",
                    visualElements: ["기원", "별", "사랑", "칠석"],
                    location: "마당, 하늘",
                    season: "칠석"
                },
                "백중공양": {
                    description: "백중 공양을 하는 사진",
                    keywords: ["백중공양", "백중", "공양", "부모", "효도"],
                    searchTerms: "백중공양 백중 공양 부모 효도",
                    visualElements: ["공양", "부모", "효도", "감사"],
                    location: "사찰, 집",
                    season: "백중"
                },
                "중양절등고": {
                    description: "중양절에 산에 오르는 사진",
                    keywords: ["중양절", "등고", "등산", "가을", "국화"],
                    searchTerms: "중양절 등고 등산 가을 국화",
                    visualElements: ["등산", "가을", "국화", "자연"],
                    location: "산, 공원",
                    season: "중양절"
                },
                "상달김장": {
                    description: "상달 김장을 하는 사진",
                    keywords: ["상달김장", "김장", "겨울준비", "가족", "전통"],
                    searchTerms: "상달김장 김장 겨울준비 가족",
                    visualElements: ["배추", "김치", "가족", "겨울준비"],
                    location: "마당, 부엌",
                    season: "상달"
                },
                "납월제사": {
                    description: "납월 제사를 지내는 사진",
                    keywords: ["납월제사", "납월", "제사", "조상", "겨울"],
                    searchTerms: "납월제사 납월 제사 조상 겨울",
                    visualElements: ["제사", "조상", "겨울", "정성"],
                    location: "집안",
                    season: "납월"
                },
                "섣달그믐": {
                    description: "섣달그믐 풍습 사진",
                    keywords: ["섣달그믐", "섣달", "그믐", "설날준비", "전통"],
                    searchTerms: "섣달그믐 섣달 그믐 설날준비",
                    visualElements: ["설날준비", "전통", "겨울", "새해"],
                    location: "집안",
                    season: "섣달그믐"
                }
            },
            
            // 시각적 자료 및 그림 정보
            visualMaterials: {
                "달집태우기": {
                    description: "정월대보름에 달집을 태우는 모습",
                    elements: ["솔가지", "볏단", "불꽃", "달집", "시민들"],
                    colors: ["빨강", "주황", "노랑", "검정", "갈색"],
                    mood: "따뜻하고 화사한 분위기"
                },
                "정월대보름": {
                    description: "정월대보름 풍경",
                    elements: ["보름달", "달집", "부럼", "오곡밥", "지신밟기"],
                    colors: ["흰색", "노랑", "주황", "갈색"],
                    mood: "평화롭고 축복받는 분위기"
                },
                "윷놀이": {
                    description: "가족이 함께 윷놀이를 하는 모습",
                    elements: ["윷", "윷판", "말", "가족들", "웃음"],
                    colors: ["빨강", "파랑", "노랑", "초록", "흰색"],
                    mood: "즐겁고 화목한 분위기"
                },
                "강강술래": {
                    description: "추석 밤 강강술래를 추는 모습",
                    elements: ["여성들", "원형", "손잡기", "춤", "노래"],
                    colors: ["한복의 화려한 색상", "보름달", "어둠"],
                    mood: "아름답고 신비로운 분위기"
                },
                "그네뛰기": {
                    description: "단오날 그네뛰기를 하는 모습",
                    elements: ["그네", "여성", "나무", "하늘", "바람"],
                    colors: ["한복의 화려한 색상", "초록", "파랑", "흰색"],
                    mood: "신나고 자유로운 분위기"
                },
                "송편빚기": {
                    description: "추석에 송편을 빚는 모습",
                    elements: ["송편", "쌀가루", "팥", "가족들", "반죽"],
                    colors: ["흰색", "빨강", "갈색", "초록"],
                    mood: "따뜻하고 정성스러운 분위기"
                },
                "떡국먹기": {
                    description: "설날 아침 떡국을 먹는 모습",
                    elements: ["떡국", "가족들", "상", "한복", "웃음"],
                    colors: ["흰색", "빨강", "노랑", "갈색"],
                    mood: "따뜻하고 축복받는 분위기"
                },
                "연날리기": {
                    description: "설날에 연을 날리는 모습",
                    elements: ["연", "하늘", "아이들", "바람", "실"],
                    colors: ["화려한 연의 색상", "파랑", "흰색"],
                    mood: "즐겁고 희망적인 분위기"
                }
            }
        };

        // 한국어 조사 처리 함수
        function getKoreanParticle(word) {
            const lastChar = word.charCodeAt(word.length - 1);
            const lastCharIndex = lastChar - 0xAC00;
            const lastConsonant = lastCharIndex % 28;
            return lastConsonant === 0 ? "는" : "은";
        }

        // 사진 검색 함수
        function searchPhoto(keyword) {
            const photo = sesiData.photoMaterials[keyword];
            if (photo) {
                return {
                    description: photo.description,
                    keywords: photo.keywords,
                    searchTerms: photo.searchTerms,
                    visualElements: photo.visualElements,
                    location: photo.location,
                    season: photo.season
                };
            }
            return null;
        }

        // 이미지 검색 링크 생성 함수
        function generateImageSearchLink(searchTerms) {
            const encodedTerms = encodeURIComponent(searchTerms);
            return `https://www.google.com/search?q=${encodedTerms}&tbm=isch`;
        }

        // 네이버 이미지 검색 링크 생성 함수
        function generateNaverImageSearchLink(searchTerms) {
            const encodedTerms = encodeURIComponent(searchTerms);
            return `https://search.naver.com/search.naver?where=image&sm=tab_jum&query=${encodedTerms}`;
        }

        // 실시간 검색 함수 (학습되지 않은 내용용)
        function generateRealTimeSearchLinks(keyword) {
            const encodedKeyword = encodeURIComponent(keyword);
            return {
                google: `https://goo.gl/search?q=${encodedKeyword}`,
                naver: `https://search.naver.com/search.naver?query=${encodedKeyword}`,
                naverImage: `https://search.naver.com/search.naver?where=image&query=${encodedKeyword}`,
                naverDict: `https://dict.naver.com/search.dict?dicQuery=${encodedKeyword}`
            };
        }

        // 전통 풍습 설명 함수
        function getTraditionalCustomExplanation(customName) {
            const customs = {
                "지신밟기": "집 안팎을 돌면서 지신(집신)을 밟아 액운을 쫓는 풍습으로, 정월대보름에 행해집니다.",
                "귀밝이술": "정월대보름에 마시는 술로, 한 해 동안 귀가 밝아지도록 기원하는 의미입니다.",
                "창포주": "단오에 창포를 넣어 담근 술로, 머리를 맑게 하고 건강을 기원합니다.",
                "강강술래": "추석 밤에 여성들이 손을 맞잡고 원을 그리며 노래하고 춤추는 전통 민속놀이입니다.",
                "수리취떡": "단오에 먹는 떡으로, 수리취의 독특한 향으로 악귀를 쫓는다고 믿습니다.",
                "오색나물": "정월대보름에 먹는 다섯 가지 색깔의 나물로, 건강과 풍년을 기원합니다.",
                "송편": "추석에 빚는 전통 떡으로, 보름달을 닮은 모양으로 풍요와 단결을 상징합니다.",
                "팥죽": "동지에 먹는 전통 음식으로, 팥의 빨간색이 악귀를 쫓는다고 믿습니다.",
                "부럼": "정월대보름에 먹는 견과류로, 부스럼(피부가 빨갛게 되거나 부어오르는 증상)이 생기지 않도록 기원합니다.",
                "오곡밥": "정월대보름에 먹는 다섯 가지 곡식으로 지은 밥으로, 풍년을 기원합니다.",
                "창포물": "단오에 창포로 머리를 감는 풍습으로, 머리를 맑게 하고 건강을 기원합니다.",
                "달맞이": "정월대보름에 보름달을 보며 소원을 빌거나 풍년을 기원하는 풍습입니다.",
                "성묘": "조상의 묘에 찾아가 인사하고 차례를 지내는 풍습입니다.",
                "차례": "명절이나 정해진 날에 조상님들에게 지내는 제사예요. 옛날에는 여러 날에 지냈지만 요즘은 주로 설날과 추석에만 지내요. 간단하게 지내는 제사라서 다른 제사보다 음식이나 방법이 쉬워요. 설날 차례에는 떡국을, 추석 차례에는 송편을 올린답니다.",
                "세배": "설날에 어른들에게 인사하는 예의입니다.",
                "윷놀이": "작은 나무를 쪼개어 4개로 만든 윷을 던져서 윷판의 말을 이동시켜 승부를 겨루는 민속놀이입니다. 도는 1칸, 개는 2칸, 걸은 3칸, 윷은 4칸, 모는 5칸 말을 이동할 수 있고, 윷이나 모가 나올 때는 한 번 더 던질 수 있어서 더 멀리 이동할 수 있습니다. 보통 설날부터 대보름까지 하는데, 특히 대보름에 많이 하는 민속놀이입니다. 옛날에는 이기는 편에 풍년이 든다고 믿었습니다.",
                "연날리기": "연을 만들어 하늘에 띄우는 놀이로, 나쁜 기운을 날려보냅니다.",
                "널뛰기": "널이라고 부르는 긴 나무판의 가운데에 짚단이나 멍석을 받치고, 양쪽 끝에 한 사람씩 올라서서 번갈아 뛰어오르는 놀이예요. 주로 여자들이 설날, 단오, 추석에 즐겼어요. 노래를 부르며 놀기도 하고, 균형을 잃고 떨어지면 지는 거예요. 다리를 튼튼하게 하고 균형감을 길러주는 놀이랍니다.",
                "제기차기": "엽전이나 쇠붙이를 종이나 천으로 싸서 만든 제기를 발로 차는 놀이예요. 주로 겨울철 설날에 많이 하는 놀이로, 제기를 떨어뜨리지 않고 계속 차야 해요. 집중력을 높여주고 몸도 튼튼하게 만드는 놀이랍니다.",
                "팽이치기": "둥글고 짧은 나무를 뾰족하게 깎아 만든 팽이를 채로 쳐서 돌리는 놀이예요. 주로 겨울철 설날에 많이 했어요. 평평한 땅이나 얼음판에서 팽이를 돌려서 누가 더 오래 돌리는지 겨루거나, 상대방 팽이를 맞춰서 쓰러뜨리기도 해요.",
                "그네뛰기": "그네에 올라가서 앞뒤로 흔들리는 놀이로, 단오의 대표 놀이입니다.",
                "씨름": "두 사람이 서로 맞잡고 상대방을 넘어뜨리는 놀이입니다.",
                "활쏘기": "활로 과녁을 쏘는 놀이입니다.",
                "화전놀이": "삼짇날에 화전을 만들어 즐기는 놀이입니다.",
                "국화전": "중양절에 국화를 넣어 만든 전입니다.",
                "국화주": "중양절에 국화를 넣어 담근 술입니다.",
                "등고": "산에 올라가서 경치를 감상하는 풍습입니다.",
                "물놀이": "시원한 물에서 노는 놀이입니다.",
                "견우직녀": "칠석의 전설에 나오는 남녀 주인공입니다.",
                "칠석제": "칠석에 견우와 직녀를 기리는 제사입니다.",
                "백중제": "백중에 지내는 제사입니다.",
                "상달고사": "가을 수확 후 지내는 고사입니다.",
                "복조리": "정월대보름에 만드는 대나무로 엮은 조롱박 모양의 용기로, 복을 담는다는 의미가 있습니다.",
                "복주머니": "설날에 허리에 차는 작은 주머니로, 복이 많이 오라는 의미가 있어요. 예쁘게 수를 놓아서 만들었답니다.",
                "설빔": "설날에 입는 새 옷이에요. 한복처럼 예쁜 옷을 입고 새해를 깨끗하게 시작한다는 의미가 있어요.",
                "달집태우기": "정월대보름에 달집에 불을 붙여 태우는 행사로, 나쁜 기운을 태워버리고 풍년을 기원해요.",
                "쥐불놀이": "정월대보름에 논밭에 불을 붙여서 쥐와 해충을 쫓아내고 농사 준비를 하는 놀이예요.",
                "다리밟기": "정월대보름에 다리를 밟으면 다리가 튼튼해진다고 믿었던 풍습이에요.",
                "가수": "설이나 대보름에 과일나무 가지 사이에 돌을 끼워서 열매가 많이 열리기를 바라는 풍습이에요. '나무시집보내기'라고도 불러요.",
                "고싸움": "볏짚으로 만든 고를 맞대고 두 편이 서로 밀어붙여서 승부를 겨루는 대보름 놀이예요. 풍년을 바라는 마음으로 해요.",
                "귀밝이술": "대보름날 아침에 귀가 밝아지라고 마시는 술이에요. 귀가 밝아지고 좋은 소식을 듣게 해달라고 마셔요.",
                "더위팔기": "대보름날 아침에 다른 사람에게 더위를 파는 풍습이에요. '내 더위 사가라'라고 하면 그해 여름에 더위를 안 먹어요.",
                "약밥": "찹쌀에 대추, 밤, 잣, 꿀을 섞어서 찐 음식이에요. 대보름에 먹는 달콤한 밥이랍니다.",
                "나물": "산이나 들에서 캔 풀로 만든 반찬이에요. 대보름에는 묵은나물을 아홉 가지 먹어요.",
                "줄다리기": "두 편으로 나뉘어 굵은 밧줄을 당겨서 승부를 겨루는 놀이예요. 대보름에 많이 하고, 이기는 편이 풍년이 든다고 믿었어요.",
                "지신밟기": "마을 사람들이 집마다 돌며 '지신'을 밟아서 달래는 풍속이에요. 지신은 집터와 가정을 지켜주는 신이에요. 설에서 대보름 사이에 하며, 마을에 나쁜 일이 생기지 않길 바라며 하는 '마을굿'이 끝나면 각 집을 차례대로 찾아가서 지신밟기를 해요. 지신을 위로하거나 지신의 심술을 달래기 위해서 하는데, 지신이 심술을 부리면 가정이 무사하지 못하다고 생각해요. 풍물놀이(꽹과리, 장구, 북, 징, 태평소 등)도 함께 하며, 한 해 동안 마을과 가정에 아무 일이 없기를 바라는 마음과 농사가 잘되기를 바라는 마음이 담겨 있어요.",
                "횃불싸움": "대보름날 저녁에 이웃 마을과 횃불로 싸우는 놀이예요. 마을이 무사하고 농사가 잘 되기를 바라는 마음으로 했어요.",
                "가래떡": "쌀가루를 쪄서 둥글고 길게 늘인 떡이에요. 떡국을 만들 때 가래떡을 동그랗게 썰어서 넣어요.",
                "강정": "찹쌀가루를 반죽해서 기름에 튀긴 전통 과자예요. 설날에 차례상에 올리거나 손님에게 대접해요.",
                "덕담": "새해에 서로 잘되기를 바라며 하는 좋은 말이에요. 어른들이 아이들에게 해주는 새해 인사말이랍니다.",
                "세찬": "설날에 차례상이나 손님을 위해 준비하는 음식이에요. 떡국, 강정, 수정과 같은 것들이 있어요.",
                "세주": "설날에 나쁜 일을 막고 건강하게 지내기를 바라며 마시는 차가운 술이에요.",
                "수정과": "생강과 계피를 넣고 끓인 물에 곶감과 잣을 띄운 전통 음료예요. 설날에 많이 마셔요.",
                "세화": "새해를 축하하기 위해 문이나 벽에 붙이는 그림이에요. 신선이나 모란꽃, 십장생을 그려요.",
                "문배": "나쁜 귀신을 막기 위해 새해에 문에 붙이는 그림이나 글씨예요.",
                "야광귀": "설날 밤에 하늘에서 내려와 신발을 훔쳐가는 귀신이에요. 신발을 감추거나 체를 걸어두면 막을 수 있어요.",
                "청참": "새해 첫날 아침에 처음 듣는 짐승 소리로 운세를 알아보는 풍습이에요. 까치 소리를 들으면 좋은 일이 생겨요.",
                "강릉단오제": "단오에 강원도 강릉에서 열리는 큰 축제예요. 제사를 지내고 가면극, 농악놀이, 씨름 대회 같은 행사를 해요. 유네스코 문화유산이랍니다.",
                "그네뛰기": "큰 나무에 줄을 걸고 발판을 만들어서 앞뒤로 왔다갔다하며 타는 놀이예요. 단오에 여자들이 많이 즐겼어요. 그네를 뛰면 여름에 모기에 안 물리고 더위를 안 탄다고 믿었어요.",
                "창포물": "창포를 넣고 삶은 물이에요. 단오에 창포물로 머리를 감으면 나쁜 귀신을 막고 머리가 건강해진다고 믿었어요.",
                "창포비녀": "창포 뿌리를 깎아 만든 비녀예요. 단오에 여자들이 머리에 꽂아서 나쁜 일을 막았어요. 붉은색으로 칠해서 더 효과가 있다고 믿었어요.",
                "수리취떡": "수리취 잎을 삶아서 쌀가루와 섞어 찐 떡이에요. 단오에 먹으면 건강해지고 나쁜 일을 막을 수 있다고 믿었어요.",
                "앵두화채": "앵두에 오미자 국물을 섞어서 만든 시원한 음료예요. 단오 무렵에 먹으면 여름을 시원하게 보낼 수 있어요.",
                "부채": "손으로 흔들어 바람을 일으키는 물건이에요. 단오에 부채를 선물로 주고받으며 더운 여름을 잘 보내라는 의미예요.",
                "단오빔": "단오에 입는 새 옷이에요. 여름을 잘 보낼 수 있는 시원한 모시옷을 입었어요.",
                "대추나무시집보내기": "단오에 대추나무를 도끼로 두드려서 열매가 많이 열리게 하는 풍습이에요.",
                "한가위": "추석을 일컫는 다른 이름이에요. '큰 가을 한가운데 날'이라는 뜻이랍니다.",
                "귀성": "명절에 고향에 사는 부모님을 만나러 가는 일이에요. 설과 추석에 많이 해요.",
                "소놀이": "추석에 한 해 농사를 위해 고생한 소와 농부를 위로하는 놀이예요. 두 사람이 멍석을 뒤집어쓰고 소 흉내를 내요.",
                "토란국": "토란을 넣어 끓인 국이에요. 추석에 먹으면 소화가 잘 되고 배탈을 예방해요.",
                "추석빔": "추석에 입는 새 옷이에요. 가을과 겨울을 보낼 수 있는 두꺼운 옷을 입었어요.",
                "길쌈놀이": "여자들이 함께 베를 짜면서 노는 놀이예요. 누가 더 좋은 옷감을 짰는지 겨뤄요.",
                "꼬리따기": "추석에 하는 아이들 놀이예요. 한 줄로 늘어서서 맨 끝 사람을 잡는 놀이랍니다.",
                "문지기놀이": "추석에 하는 아이들 놀이예요. 두 사람이 대문을 만들고 다른 아이들이 빠져나가는 놀이예요.",
                "동지팥죽": "동지에 팥을 넣고 끓인 죽이에요. 새알심이라는 찹쌀 경단을 넣어요. 나이 수만큼 새알심을 먹으면 한 살 더 먹는다고 해요.",
                "팥죽뿌리기": "동지에 팥죽을 집안 곳곳에 뿌려서 나쁜 귀신을 막는 풍습이에요. 팥의 붉은색을 귀신이 싫어한다고 믿었어요.",
                "동지책력": "동지에 새해 달력을 선물하는 풍습이에요. 농사를 잘 짓기 위해 달력이 중요했어요.",
                "아세": "동지를 부르는 다른 이름이에요. '작은 설'이라는 뜻으로, 새해의 시작처럼 여겼어요."
            };
            
            return customs[customName] || null;
        }

        // 초등학교 3학년 수준으로 답변을 쉽게 만드는 함수
        function simplifyAnswer(answer) {
            // 불릿 포인트를 문장형으로 변환
            let simplified = answer;
            
            // 복잡한 불릿 포인트 구조를 간단한 문장으로 변환
            if (simplified.includes('•')) {
                // 제목과 내용 분리
                const sections = simplified.split(/\n\n/);
                let result = '';
                
                for (let section of sections) {
                    if (section.includes('•')) {
                        // 불릿 포인트를 문장으로 변환
                        const lines = section.split('\n');
                        const title = lines[0];
                        const bullets = lines.slice(1).filter(line => line.trim().startsWith('•'));
                        
                        if (bullets.length > 0 && !title.includes('🎭') && !title.includes('🎲') && !title.includes('🍜')) {
                            // 제목 제거하고 주요 내용만 추출
                            const mainPoints = bullets.slice(0, 2).map(line => 
                                line.replace('•', '').trim()
                            );
                            result += mainPoints.join(' ') + '\n\n';
                        }
                    } else if (!section.match(/^[🎭🎲🍜🪁🎪🤼🦘🌙🌿🍲🍚🥜🍶🌕🕯️🙏]/)) {
                        result += section + '\n\n';
                    }
                }
                
                // 너무 긴 답변은 요약
                if (result.length > 300) {
                    const sentences = result.split(/[.!?]\s+/);
                    result = sentences.slice(0, 3).join('. ') + '.';
                }
                
                return result.trim();
            }
            
            return simplified;
        }

        // 오타 수정 함수
        function fixTypo(question) {
            // '머'를 '뭐'로 수정하는 일반적인 오타 패턴들
            const typoPatterns = [
                { from: /머야/g, to: '뭐야' },
                { from: /머해/g, to: '뭐해' },
                { from: /머먹어/g, to: '뭐먹어' },
                { from: /머예요/g, to: '뭐예요' },
                { from: /머인가요/g, to: '뭐인가요' },
                { from: /머하나요/g, to: '뭐하나요' },
                { from: /머하나/g, to: '뭐하나' },
                { from: /머인가/g, to: '뭐인가' },
                { from: /머먹나요/g, to: '뭐먹나요' },
                { from: /머먹나/g, to: '뭐먹나' },
                { from: /머하나요/g, to: '뭐하나요' },
                { from: /머하나/g, to: '뭐하나' },
                { from: /머하세요/g, to: '뭐하세요' },
                { from: /머하시나요/g, to: '뭐하시나요' },
                { from: /머하시나/g, to: '뭐하시나' },
                { from: /머하시는/g, to: '뭐하시는' },
                { from: /머하시는지/g, to: '뭐하시는지' },
                { from: /머하시는가요/g, to: '뭐하시는가요' },
                { from: /머하시는가/g, to: '뭐하시는가' },
                { from: /머하시는지요/g, to: '뭐하시는지요' },
                { from: /머하시는지/g, to: '뭐하시는지' },
                { from: /머하시는/g, to: '뭐하시는' },
                { from: /머하시나요/g, to: '뭐하시나요' },
                { from: /머하시나/g, to: '뭐하시나' },
                { from: /머하세요/g, to: '뭐하세요' },
                { from: /머하나요/g, to: '뭐하나요' },
                { from: /머하나/g, to: '뭐하나' },
                { from: /머해요/g, to: '뭐해요' },
                { from: /머해/g, to: '뭐해' },
                { from: /머먹어요/g, to: '뭐먹어요' },
                { from: /머먹어/g, to: '뭐먹어' },
                { from: /머먹나요/g, to: '뭐먹나요' },
                { from: /머먹나/g, to: '뭐먹나' },
                { from: /머먹는/g, to: '뭐먹는' },
                { from: /머먹는지/g, to: '뭐먹는지' },
                { from: /머먹는가요/g, to: '뭐먹는가요' },
                { from: /머먹는가/g, to: '뭐먹는가' },
                { from: /머먹는지요/g, to: '뭐먹는지요' },
                { from: /머먹는지/g, to: '뭐먹는지' },
                { from: /머먹는/g, to: '뭐먹는' },
                { from: /머먹나요/g, to: '뭐먹나요' },
                { from: /머먹나/g, to: '뭐먹나' },
                { from: /머먹어요/g, to: '뭐먹어요' },
                { from: /머먹어/g, to: '뭐먹어' },
                { from: /머예요/g, to: '뭐예요' },
                { from: /머인가요/g, to: '뭐인가요' },
                { from: /머인가/g, to: '뭐인가' },
                { from: /머야/g, to: '뭐야' }
            ];
            
            let correctedQuestion = question;
            
            // 각 오타 패턴을 적용
            typoPatterns.forEach(pattern => {
                correctedQuestion = correctedQuestion.replace(pattern.from, pattern.to);
            });
            
            return correctedQuestion;
        }

        // 답변 생성 함수 (포괄적인 버전)
        function findAnswer(question) {
            // 오타 수정 적용
            const correctedQuestion = fixTypo(question);
            const lowerQuestion = correctedQuestion.toLowerCase();
            
            // 일반적인 질문 패턴 감지 (오타 포함)
            const questionPatterns = {
                yesNo: /(하나요|인가요|되나요|맞나요|있나요|없나요|하나|인가|되나|맞나|있나|없나)\?*$/,
                what: /(뭐야|머야|뭔가|무엇인가|뭐예요|머예요|뭡니까|머인가요|머인가)/,
                why: /(왜|어째서|무슨 이유로|어떻게)/,
                how: /(어떻게|어떤|어떠한|어떤 방식으로)/,
                when: /(언제|몇 월|몇 일|어느 시기에)/,
                where: /(어디서|어느 곳에서|어디에)/,
                who: /(누가|누구가|누구에게서)/
            };
            
            // 질문 유형 분석
            function analyzeQuestionType(question) {
                const patterns = [];
                for (const [type, pattern] of Object.entries(questionPatterns)) {
                    if (pattern.test(question)) {
                        patterns.push(type);
                    }
                }
                return patterns;
            }
            
            const questionTypes = analyzeQuestionType(lowerQuestion);
            
            // 세시풍속 기본 개념 질문 (최우선 처리)
            if (lowerQuestion.includes('세시풍속') && (lowerQuestion.includes('뭐') || lowerQuestion.includes('무엇') || lowerQuestion.includes('의미') || lowerQuestion.includes('뜻'))) {
                return `세시풍속은 1월부터 12월까지 매년 같은 시기에 되풀이해서 하는 우리나라의 전통 풍습이에요. 옛날 우리 조상들은 농사를 지으면서 살았기 때문에 농사와 관련된 풍습이 많아요. 그래서 '농경 의례'라고도 부른답니다.

세시풍속에는 설날, 추석 같은 명절과 24절기가 있어요. 그리고 그때마다 하는 일, 놀이, 먹는 음식들이 모두 달라요. 세시풍속은 주로 음력(옛날 달력)을 기준으로 하지만, 동지 같은 날은 양력(지금 쓰는 달력)을 기준으로 하기도 해요.

옛날에는 농사가 잘 되게 해달라고 기원하는 행사가 많았어요. 하지만 요즘은 많이 간소해졌고, 외국에서 들어온 새로운 문화도 생겼어요. 그래서 옛날처럼 하지 않는 풍습도 많답니다.`;
            }
            
            // 전통문화 기본 개념 질문
            if (lowerQuestion.includes('전통문화') && (lowerQuestion.includes('뭐') || lowerQuestion.includes('무엇') || lowerQuestion.includes('의미') || lowerQuestion.includes('뜻'))) {
                return '전통문화는 우리 조상들이 오래전부터 해온 문화예요. 세시풍속, 한복, 한옥, 전통 음식과 놀이들이 포함돼요. 우리만의 특별한 문화라서 소중히 지켜야 해요.';
            }
            
            // 명절 기본 개념 질문
            if (lowerQuestion.includes('명절') && (lowerQuestion.includes('뭐') || lowerQuestion.includes('무엇') || lowerQuestion.includes('의미') || lowerQuestion.includes('뜻'))) {
                return `명절은 때를 정해서 해마다 일정하게 지켜 즐기거나 기념하는 특별한 날이에요.

🎊 어떤 명절이 있나요
잘 알려진 명절에는 설날과 추석이 있고, 그 외에 정월대보름, 한식, 단오, 동지가 있어요.

👨‍👩‍👧‍👦 명절에 뭘 해요
오랜만에 가족과 친척들이 한자리에 모여서 서로의 소식을 나눠요. 차례를 지내거나 성묘를 가서 조상님들을 생각하고, 떡국, 오곡밥, 송편 같은 명절 음식도 먹어요. 윷놀이, 널뛰기, 줄다리기, 씨름, 그네뛰기 같은 재미있는 민속놀이도 즐겨요.

🌾 옛날의 명절
옛날에는 사람들이 주로 농사를 지어서 명절이 농사와 깊은 관련이 있었어요.

📅 요즘의 명절
요즘은 농사보다 다른 일을 많이 해서 옛날처럼 다양한 명절을 다 지내지는 않아요. 주로 공휴일인 설날과 추석만 크게 기념하고, 명절 음식을 먹거나 민속놀이를 즐기는 것도 많이 사라졌답니다.`;
            }
            
            // 명절 놀이 관련 질문 처리 (포괄적 처리)
            if ((lowerQuestion.includes('무슨 놀이') || lowerQuestion.includes('뭐하고 놀아') || lowerQuestion.includes('놀이') || lowerQuestion.includes('무엇') || lowerQuestion.includes('했던')) && 
                (lowerQuestion.includes('설날') || lowerQuestion.includes('추석') || lowerQuestion.includes('단오') || lowerQuestion.includes('정월대보름') || lowerQuestion.includes('대보름') || lowerQuestion.includes('동지') || lowerQuestion.includes('한식') || lowerQuestion.includes('삼짇날') || lowerQuestion.includes('칠석') || lowerQuestion.includes('백중') || lowerQuestion.includes('추분') || lowerQuestion.includes('상사'))) {
                
                // 설날 놀이
                if (lowerQuestion.includes('설날')) {
                    return `🎮 윷놀이: 운세를 점쳐요. 🪁 연날리기: 나쁜 기운을 날려보내요. 🏃‍♀️ 널뛰기, 제기차기, 팽이치기도 해요.`;
                }
                
                // 추석 놀이
                if (lowerQuestion.includes('추석')) {
                    return `🌙 강강술래: 추석 밤에 여성들이 손을 맞잡고 원을 그리며 노래하고 춤추는 놀이예요. 🐂 소놀이, 줄다리기도 해요.`;
                }
                
                // 단오 놀이
                if (lowerQuestion.includes('단오')) {
                    return `🎪 그네뛰기: 단오의 대표 놀이로 여성들이 즐겼어요. 💪 씨름, 활쏘기도 해요.`;
                }
                
                // 정월대보름 놀이
                if (lowerQuestion.includes('정월대보름') || lowerQuestion.includes('대보름')) {
                    return `🔥 달맞이: 달을 보며 소원을 빌어요. 🐭 지신밟기, 쥐불놀이, 줄다리기도 해요.`;
                }
                
                // 동지 놀이
                if (lowerQuestion.includes('동지')) {
                    return `🍲 팥죽 먹기: 동지의 대표 풍습이에요. 팥죽을 먹고 나쁜 기운을 쫓아내요.`;
                }
                
                // 한식 놀이
                if (lowerQuestion.includes('한식')) {
                    return `🌸 성묘: 조상님께 인사드려요. 🌿 산놀이, 봄나들이도 해요.`;
                }
                
                // 삼짇날 놀이
                if (lowerQuestion.includes('삼짇날')) {
                    return `🌸 화전놀이: 화전을 만들어 즐기는 놀이예요. 🌸 산놀이, 물놀이도 해요.`;
                }
                
                // 칠석 놀이
                if (lowerQuestion.includes('칠석')) {
                    return `💕 견우직녀: 칠석제를 지내며 견우와 직녀의 만남을 기념해요. 🌟 별자리 관찰도 해요.`;
                }
                
                // 백중 놀이
                if (lowerQuestion.includes('백중')) {
                    return `🎭 백중제: 백중굿을 지내며 여름의 더위를 이겨내요. 🎪 머슴놀이도 해요.`;
                }
                
                // 추분 놀이
                if (lowerQuestion.includes('추분')) {
                    return `🌾 고사지내기: 수확을 감사하며 고사를 지내요. 🎉 고사놀이도 해요.`;
                }
                
                // 상사 놀이
                if (lowerQuestion.includes('상사')) {
                    return `🌾 고사지내기: 수확을 감사하며 고사를 지내요. 🎉 고사놀이도 해요.`;
                }
            }

            // 설날 놀이 관련 질문 처리 (오타 포함)
            if (lowerQuestion.includes('설날') && lowerQuestion.includes('놀이') && (lowerQuestion.includes('뭐') || lowerQuestion.includes('머') || lowerQuestion.includes('무엇') || lowerQuestion.includes('했던'))) {
                return `설날에 했던 놀이

🎮 윷놀이
: 작은 나무를 쪼개어 4개로 만든 윷을 던져서 윷판의 말을 이동시켜 승부를 겨루는 민속놀이예요. 도, 개, 걸, 윷, 모 결과에 따라 말을 이동시키고, 윷이나 모가 나올 때는 한 번 더 던질 수 있어요.

🪁 연날리기  
: 연을 만들어 하늘에 띄우는 놀이로, 나쁜 기운을 날려보내고 좋은 기운을 받는 의미가 있어요.

🏃‍♀️ 널뛰기
: 널판을 밟아서 뛰는 놀이로, 키가 크고 건강해지기를 기원했어요. 주로 여성들이 즐겼어요.

⚽ 제기차기
: 제기를 발로 차는 놀이로, 재치와 민첩함을 기르는 놀이예요.

🔄 팽이치기
: 팽이를 회전시키는 놀이로, 집중력과 인내심을 기르는 놀이예요.`;
            }
            
            // 윷놀이 규칙 관련 질문 처리
            if (lowerQuestion.includes('윷놀이') && (lowerQuestion.includes('규칙') || lowerQuestion.includes('방법') || lowerQuestion.includes('어떻게'))) {
                return `윷놀이 게임 방법
🎯 윷 만들기
: 작은 나무를 쪼개어 4개로 만들어요.
🎲 윷 던지기
: 4개의 윷을 던져서 나온 결과를 확인해요.
🏃 말 이동하기
: 도는 1칸, 개는 2칸, 걸은 3칸, 윷은 4칸, 모는 5칸 말을 이동해요.
🔄 추가 기회
: 윷이나 모가 나올 때는 한 번 더 던질 수 있어요.
🏆 승부 결정
: 모든 말이 최종 도착지를 먼저 통과하는 편이 이겨요.
⏰ 놀이 시간
: 설날부터 대보름까지 하는데, 특히 대보름에 많이 해요.`;
            }
            
            // 절기 기본 개념 질문
            if (lowerQuestion.includes('절기') && (lowerQuestion.includes('뭐') || lowerQuestion.includes('무엇') || lowerQuestion.includes('의미') || lowerQuestion.includes('뜻'))) {
                return '절기는 계절을 나누는 기준이에요. 봄, 여름, 가을, 겨울을 더 세분화한 거예요. 조상들이 농사짓기에 좋은 때를 알기 위해 만들었어요.';
            }
            
            // 풍습 기본 개념 질문
            if (lowerQuestion.includes('풍습') && (lowerQuestion.includes('뭐') || lowerQuestion.includes('무엇') || lowerQuestion.includes('의미') || lowerQuestion.includes('뜻'))) {
                return `✨ 풍습이란?

풍습은 옛날부터 우리 조상들이 계속해서 해온 생활 습관을 말해요.

🌾 우리나라의 풍습:
• 우리나라는 주로 농사와 관련된 풍습이 많아요
• 농사를 지으면서 생겨난 습관들이 지금까지 이어져 오고 있어요

🗺️ 지역마다 다른 풍습:
• 각 지역마다 조금씩 다른 풍습들이 있어요
• 오늘날에도 여러 지역에서 다양한 풍습들이 이어지고 있어요

🎊 풍습의 예시:
• 설날에 세배하는 것
• 추석에 송편 빚는 것
• 단오에 그네 타는 것
• 정월대보름에 부럼 깨무는 것

풍습은 우리 조상들의 지혜가 담긴 소중한 문화예요! 😊`;
            }
            
            // 복조리 관련 문맥 분석 (우선순위 높임)
            if (lowerQuestion.includes('복조리')) {
                if (lowerQuestion.includes('왜') || lowerQuestion.includes('이유')) {
                    return `복조리는 대나무로 엮어서 만든 조롱박 모양의 용기예요.

🎊 복을 담는 용기
복조리를 집에 걸어두면 복이 많이 들어온다고 믿었어요. '복을 담는 조리'라는 뜻이에요.

📅 언제 만들까요
주로 정월대보름에 만들지만, 설날에도 복을 바라는 마음으로 집에 걸어두었어요.

🏠 어디에 걸까요
부엌이나 대문에 걸어두면 한 해 동안 복이 가득 차기를 바랐답니다.`;
                }
                // 정월대보름 관련 문맥이거나 일반적인 복조리 질문
                if (lowerQuestion.includes('정월대보름') || lowerQuestion.includes('대보름') || lowerQuestion.includes('보름')) {
                    return getTraditionalCustomExplanation('복조리');
                }
                
                // 복조리 일반 질문
                return getTraditionalCustomExplanation('복조리');
            }
            
            // 복주머니 관련 질문
            if (lowerQuestion.includes('복주머니')) {
                if (lowerQuestion.includes('왜') || lowerQuestion.includes('이유')) {
                    return `복주머니는 설날에 허리에 차는 작은 주머니예요.

🎊 복을 담는 주머니
복주머니를 차면 복이 많이 온다고 믿었어요. 작은 주머니 안에 복이 가득 차기를 바랐답니다.

🎨 예쁘게 만들어요
형형색색 예쁜 천으로 만들고 수를 놓아서 아주 예뻐요. 엄마나 할머니가 정성스럽게 만들어주셨어요.

👗 설빔과 함께
설빔이라는 새 옷을 입고 복주머니를 허리에 차면 더욱 멋있고 복도 많이 받는다고 생각했어요.`;
                }
                return getTraditionalCustomExplanation('복주머니');
            }

            // 전통 놀이 "왜 하는지" 질문 처리
            if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('놀이'))) {
                if (lowerQuestion.includes('윷놀이')) {
                    return `윷놀이의 특징
🎮 게임 방법
: 작은 나무를 쪼개어 4개로 만든 윷을 던져서 윷판의 말을 이동시켜 승부를 겨루는 민속놀이예요.
🎲 윷의 결과
: 도는 1칸, 개는 2칸, 걸은 3칸, 윷은 4칸, 모는 5칸 말을 이동할 수 있어요. 윷이나 모가 나올 때는 한 번 더 던질 수 있어서 더 멀리 이동할 수 있어요.
⏰ 놀이 시기
: 보통 설날부터 대보름까지 하는데, 특히 대보름에 많이 하는 민속놀이예요.
👥 참여 대상
: 남자, 여자, 노인, 아이 누구나 함께 즐길 수 있고 어디에서나 할 수 있는 놀이예요.
🌟 의미
: 옛날에는 이기는 편에 풍년이 든다고 믿었어요. 가족 간의 화합과 재미를 위한 놀이예요.`;
                }
                if (lowerQuestion.includes('연날리기')) {
                    // 이유를 묻는 질문인지 확인
                    if (lowerQuestion.includes('왜') || lowerQuestion.includes('이유')) {
                        return `연날리기를 하는 이유
🌪️ 나쁜 기운을 날려보내기 위해서
: 연을 높이 날려 나쁜 기운을 하늘로 보내고 새해의 액운과 불운을 날려보내는 의미가 있어요.
🎯 집중력과 인내심을 기르기 위해서
: 연을 안정적으로 띄우기 위한 집중력과 끈기를 개발하고 바람의 방향과 세기를 파악하는 자연 관찰력을 향상시켜요.
🏃 신체 활동과 사회성을 기르기 위해서
: 넓은 공터에서 뛰어다니며 하는 건강한 운동으로 다른 아이들과 함께 연을 날리며 협동심을 기를 수 있어요.`;
                    } else {
                        // 일반적인 연날리기 설명
                        const yeonnalligi = sesiData.games.연날리기;
                        return `연날리기${getKoreanParticle('연날리기')} ${yeonnalligi.description}로, ${yeonnalligi.meaning}입니다. ${yeonnalligi.details}`;
                    }
                }
                if (lowerQuestion.includes('그네뛰기')) {
                    // 이유를 묻는 질문인지 확인
                    if (lowerQuestion.includes('왜') || lowerQuestion.includes('이유')) {
                        return `그네뛰기를 하는 이유
💪 건강과 체력을 기르기 위해서
: 전신 근육을 사용하는 균형 잡힌 운동으로 유연성과 균형감각을 기르는 자연스러운 체력 단련이에요.
👩 여성의 아름다움을 추구하기 위해서
: 전통적으로 여성들이 즐겨 했던 우아한 놀이로 여성의 건강과 아름다움을 기원하는 의미가 있어요.
🕊️ 자유로운 표현과 사회적 교류를 위해서
: 일상의 구속에서 벗어나 자유로운 표현을 즐기는 시간으로 마을 사람들과의 자연스러운 만남과 교류를 할 수 있어요.`;
                    } else {
                        // 일반적인 그네뛰기 설명
                        const geuneTtwigi = sesiData.games.그네뛰기;
                        return `그네뛰기${getKoreanParticle('그네뛰기')} ${geuneTtwigi.description}로, ${geuneTtwigi.meaning}입니다. ${geuneTtwigi.details}`;
                    }
                }
                if (lowerQuestion.includes('씨름')) {
                    // 이유를 묻는 질문인지 확인
                    if (lowerQuestion.includes('왜') || lowerQuestion.includes('이유')) {
                        return `씨름을 하는 이유
💪 힘과 용맹함을 겨루기 위해서
: 남성들의 힘과 용맹함을 겨루는 전통적인 스포츠로, 정신력과 체력을 기르는 운동이에요.
🏆 마을의 명예를 걸고 겨루기 위해서
: 마을의 대표 선수로 나서 마을의 명예를 걸고 겨루는 경기예요.
🤝 공동체 화합을 다지기 위해서
: 마을 사람들이 함께 모여 응원하며 즐기는 축제로, 마을의 단결과 화합을 다지는 시간이에요.`;
                    } else {
                        // 일반적인 씨름 설명
                        const ssireum = sesiData.games.씨름;
                        return `씨름${getKoreanParticle('씨름')} ${ssireum.description}로, ${ssireum.meaning}입니다. ${ssireum.details}`;
                    }
                }
                if (lowerQuestion.includes('널뛰기')) {
                    // 이유를 묻는 질문인지 확인
                    if (lowerQuestion.includes('왜') || lowerQuestion.includes('이유')) {
                        return `널뛰기를 하는 이유
📏 키가 크고 건강해지기를 바라기 위해서
: 널뛰기를 하면 키가 크고 건강해진다는 전통적 믿음이 있어요.
💪 건강과 체력을 기르기 위해서
: 전신 근육을 사용하는 균형 잡힌 운동으로 유연성과 민첩성을 기르는 운동이에요.
🤝 협동과 소통을 배우기 위해서
: 두 사람이 서로 맞춰서 함께 뛰는 협동 놀이로 상대방과의 호흡을 맞추는 소통 능력을 기를 수 있어요.`;
                    } else {
                        // 일반적인 널뛰기 설명
                        const neolTtwigi = sesiData.games.널뛰기;
                        return `널뛰기${getKoreanParticle('널뛰기')} ${neolTtwigi.description}로, ${neolTtwigi.meaning}입니다. ${neolTtwigi.details}`;
                    }
                }
            }

            // 전통 음식 "왜 하는지" 질문 처리
            if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('먹'))) {
                if (lowerQuestion.includes('떡국')) {
                    return `🍜 떡국을 왜 먹을까요?

🎂 한 살 더 먹기
떡국 한 그릇을 먹으면 한 살 더 먹는다고 해요. 
설날에 떡국을 먹으면서 새해를 맞이하는 거예요.

🌾 풍년과 건강을 바라요
하얀 떡국은 농사가 잘 되기를 바라는 마음이 담겨 있어요. 
길쭉한 떡은 오래오래 건강하게 살라는 의미예요.

👨‍👩‍👧‍👦 가족이 함께 모여요
설날 아침에 온 가족이 모여서 함께 떡국을 먹어요. 
가족들이 한자리에 모이는 소중한 시간이에요.

🍲 몸에 좋은 음식
떡과 고기, 채소가 들어가서 영양도 좋아요. 
추운 겨울에 따뜻하게 먹으면 몸도 마음도 따뜻해져요.

🙏 조상님께 올리는 음식
떡국은 조상님께도 올리는 특별한 음식이에요. 
조상님들께 감사하는 마음을 담아서 만들어요.`;
                }
                if (lowerQuestion.includes('송편')) {
                    return `송편을 먹는 이유
🌕 보름달을 닮았어요
: 둥근 모양이 추석의 보름달을 닮아서 만들어요. 가족이 화목하고 풍성하게 살라는 의미가 있어요.
🌾 추수를 감사해요
: 가을에 농사를 마치고 곡식을 많이 거두어서 기뻐하는 마음이에요. 자연이 준 선물에 감사하는 마음을 담아 만들어요.
👥 가족이 함께 만들어요
: 온 가족이 모여서 같이 송편을 빚어요. 할머니, 엄마, 아이들이 함께 만들면서 즐거운 시간을 보내요.`;
                }
                if (lowerQuestion.includes('수리취떡')) {
                    return `수리취떡을 먹는 이유
🛡️ 악귀 제거
: 수리취의 독특한 향으로 악귀와 나쁜 기운을 쫓는 의미가 있어요.
🌞 여름 건강
: 단오 시기에 먹어 여름철 건강을 미리 준비하는 음식이에요.
🌱 자연의 은혜
: 들에서 자란 수리취를 활용한 자연 친화적 음식이에요.`;
                }
                if (lowerQuestion.includes('팥죽')) {
                    return `팥죽을 먹는 이유
🔴 액운 제거
: 팥의 빨간색이 악귀를 쫓는다고 믿어 액운을 막는 의미가 있어요.
❄️ 겨울 건강
: 추운 겨울철 몸을 따뜻하게 해주는 건강한 음식으로 팥의 영양분으로 체력을 보강해요.
🌙 밤과 낮의 전환
: 일년 중 밤이 가장 긴 동지에 먹는 특별한 음식으로 긴 밤을 지내고 낮이 길어지는 것을 기념해요.`;
                }
                if (lowerQuestion.includes('오곡밥')) {
                    return `오곡밥을 먹는 이유
🌾 풍년 기원
: 다섯 가지 곡식으로 풍성한 수확을 기원하는 의미가 있어요.
🏥 건강과 영양
: 다섯 가지 곡식의 영양을 골고루 섭취하는 건강한 음식이에요.
🌕 보름달의 의미
: 정월대보름의 보름달처럼 완전함을 상징하는 음식으로 다섯 가지 곡식이 하나로 어우러져요.`;
                }
                if (lowerQuestion.includes('부럼')) {
                    return `부럼을 깨무는 이유
🦷 이빨을 튼튼하게 하기 위해서
: 딱딱한 견과류를 깨물어 이빨을 튼튼하게 하는 의미가 있어요.
🛡️ 부스럼을 막기 위해서
: 부스럼(피부가 빨갛게 되거나 부어오르는 증상)이 생기지 말라는 바람이 담겨 있어요.
💪 건강을 기원하기 위해서
: 견과류의 영양소로 건강을 지키고 액운을 예방하는 의미가 있어요.`;
                }
                if (lowerQuestion.includes('귀밝이술')) {
                    return `귀밝이술을 마시는 이유
👂 귀 밝기 기원
: 한 해 동안 귀가 밝아져서 좋은 소식만 들리기를 기원해요.
🏥 건강과 기운
: 적당한 술로 혈액 순환을 돕고 몸을 따뜻하게 하는 효과가 있어요.
🎊 명절의 분위기
: 정월대보름의 즐거운 분위기를 더욱 화기애애하게 만드는 음료예요.`;
                }
            }

            // 전통 풍습 "왜 하는지" 질문 처리
            if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('지내') || lowerQuestion.includes('감'))) {
                if (lowerQuestion.includes('창포물') || lowerQuestion.includes('창포')) {
                    return `창포물로 머리를 감는 이유
🛡️ 악귀 제거
: 창포의 독특한 향으로 악귀와 나쁜 기운을 쫓는 의미가 있어요.
🏥 건강과 위생
: 창포의 약효로 두피와 머리를 깨끗하게 하고 건강하게 유지해요.
🌞 여름 건강 준비
: 단오 시기에 창포물로 머리를 감아 여름철 건강을 미리 준비해요.`;
                }
                if (lowerQuestion.includes('세배')) {
                    return `세배를 하는 이유
🙏 어른들께 인사
: 설날 차례가 끝나면 집안 어른들께 웃어른부터 순서대로 절을 하며 새해 인사를 드려요.
💬 덕담을 들어요
: 세배를 하면 어른들이 덕담이라는 좋은 말씀을 해주세요. 복을 빌어주는 의미예요.
💰 세뱃돈을 받아요
: 어른들이 아이들에게 세뱃돈을 주기도 해요. 복을 준다는 뜻으로 '복돈'이라고도 불러요.`;
                }
                if (lowerQuestion.includes('차례')) {
                    return `차례를 지내는 이유
🙏 조상님께 감사
: 조상님들께 감사하고 존경하는 마음을 표현하는 거예요. 우리를 낳아주시고 키워주신 조상님들을 기억해요.
👨‍👩‍👧‍👦 가족이 모여요
: 온 가족이 함께 모여서 조상님을 기리며 화목한 시간을 보내요. 친척들도 만나서 서로의 안부를 묻어요.
🍚 명절 음식을 올려요
: 설날 차례에는 떡국을 올리고, 추석 차례에는 송편을 올려요. 명절 음식을 차례상에 올리는 게 특징이에요.`;
                }
                if (lowerQuestion.includes('성묘')) {
                    return `성묘를 하는 이유
🙏 조상 공경
: 조상님의 묘소를 찾아가 인사하고 존경을 표현하는 전통 의식이에요.
👨‍👩‍👧‍👦 가족의 화합
: 온 가족이 함께 조상의 묘소를 찾아가며 화합하는 시간이에요.
💝 정신적 치유
: 조상의 묘소에서 마음의 평안과 안정을 얻는 시간이에요.`;
                }
                if (lowerQuestion.includes('달맞이')) {
                    return `달맞이를 하는 이유
🌙 보름달의 의미
: 보름달을 바라보며 자연의 아름다움과 신비로움을 감상해요.
🙏 소원과 기도
: 보름달 아래에서 개인과 가족의 소망을 빌고 기도하는 시간이에요.
👨‍👩‍👧‍👦 가족의 화합
: 온 가족이 함께 보름달을 바라보며 화합하는 소중한 시간이에요.`;
                }
            }

            // 전통 풍습 관련 질문 처리 (복조리 제외)
            for (const customName in {
                "지신밟기": 1, "귀밝이술": 1, "창포주": 1, "강강술래": 1, "수리취떡": 1,
                "오색나물": 1, "송편": 1, "팥죽": 1, "부럼": 1, "오곡밥": 1,
                "창포물": 1, "달맞이": 1, "성묘": 1, "차례": 1, "세배": 1,
                "윷놀이": 1, "연날리기": 1, "널뛰기": 1, "제기차기": 1, "팽이치기": 1,
                "그네뛰기": 1, "씨름": 1, "활쏘기": 1, "화전놀이": 1, "국화전": 1,
                "국화주": 1, "등고": 1, "물놀이": 1, "견우직녀": 1, "칠석제": 1,
                "백중제": 1, "상달고사": 1, "복주머니": 1, "설빔": 1,
                "달집태우기": 1, "쥐불놀이": 1, "다리밟기": 1,
                "가래떡": 1, "강정": 1, "덕담": 1, "세찬": 1, "세주": 1,
                "수정과": 1, "세화": 1, "문배": 1, "야광귀": 1, "청참": 1,
                "가수": 1, "고싸움": 1, "더위팔기": 1, "약밥": 1, "나물": 1,
                "줄다리기": 1, "횃불싸움": 1,
                "강릉단오제": 1, "창포비녀": 1, "앵두화채": 1, "부채": 1, 
                "단오빔": 1, "대추나무시집보내기": 1, "수릿날": 1,
                "한가위": 1, "귀성": 1, "소놀이": 1, "토란국": 1,
                "추석빔": 1, "길쌈놀이": 1, "꼬리따기": 1, "문지기놀이": 1,
                "동지팥죽": 1, "팥죽뿌리기": 1, "동지책력": 1, "아세": 1
            }) {
                if (lowerQuestion.includes(customName.toLowerCase())) {
                    const explanation = getTraditionalCustomExplanation(customName);
                    if (explanation) {
                        return explanation;
                    }
                }
            }
            
            // 사진 자료 관련 질문 (우선순위 높임)
            if (lowerQuestion.includes('사진') || lowerQuestion.includes('이미지') || lowerQuestion.includes('보여줘') || lowerQuestion.includes('찾아줘')) {
                if (lowerQuestion.includes('달집태우기')) {
                    const photo = searchPhoto('달집태우기');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('윷놀이')) {
                    const photo = searchPhoto('윷놀이');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('강강술래')) {
                    const photo = searchPhoto('강강술래');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('그네뛰기')) {
                    const photo = searchPhoto('그네뛰기');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('송편')) {
                    const photo = searchPhoto('송편빚기');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('떡국')) {
                    const photo = searchPhoto('떡국먹기');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('연날리기')) {
                    const photo = searchPhoto('연날리기');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('씨름')) {
                    const photo = searchPhoto('씨름');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                
                // 지신 관련 질문 처리 (우선순위 높임) - 오타 포함
                if (lowerQuestion.includes('지신') && (lowerQuestion.includes('뭐') || lowerQuestion.includes('머') || lowerQuestion.includes('무엇'))) {
                    return `지신은 집터와 가정을 지켜주는 신이에요.`;
                }
                
                if (lowerQuestion.includes('지신밟기')) {
                    if (lowerQuestion.includes('왜') || lowerQuestion.includes('이유')) {
                        return `지신을 위로하거나 지신의 심술을 달래기 위해서 하는데, 지신이 심술을 부리면 가정이 무사하지 못하다고 생각해요. 한 해 동안 마을과 가정에 아무 일이 없기를 바라는 마음과 농사가 잘되기를 바라는 마음이 담겨 있어요.`;
                    }
                    if (lowerQuestion.includes('지신') && (lowerQuestion.includes('뭐') || lowerQuestion.includes('머') || lowerQuestion.includes('무엇'))) {
                        return `지신은 집터와 가정을 지켜주는 신이에요.`;
                    }
                    if (lowerQuestion.includes('언제') || lowerQuestion.includes('시기')) {
                        return `지신밟기는 주로 설에서 대보름 사이에 해요. 마을굿이 끝난 후 각 집을 차례대로 찾아가서 지신밟기를 합니다.`;
                    }
                    if (lowerQuestion.includes('어떻게') || lowerQuestion.includes('방법')) {
                        return `지신밟기는 마을 사람들이 집마다 돌며 지신을 밟아서 달래는 풍속이에요. 풍물놀이(꽹과리, 장구, 북, 징, 태평소 등)도 함께 하며 춤추고 노래해요.`;
                    }
                    const photo = searchPhoto('지신밟기');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('오곡밥')) {
                    const photo = searchPhoto('오곡밥');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('부럼')) {
                    const photo = searchPhoto('부럼');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('귀밝이술')) {
                    const photo = searchPhoto('귀밝이술');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('화전')) {
                    const photo = searchPhoto('화전');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('수리취떡')) {
                    const photo = searchPhoto('수리취떡');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('팥죽')) {
                    const photo = searchPhoto('팥죽');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('한과')) {
                    const photo = searchPhoto('한과');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('약과')) {
                    const photo = searchPhoto('약과');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('한복')) {
                    const photo = searchPhoto('한복');
                    const googleLink = generateImageSearchLink(photo.searchTerms);
                    const naverLink = generateNaverImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면:\n- 구글: ${googleLink}\n- 네이버: ${naverLink}`;
                }
                if (lowerQuestion.includes('제기차기')) {
                    const photo = searchPhoto('제기차기');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('팽이치기')) {
                    const photo = searchPhoto('팽이치기');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('널뛰기')) {
                    const photo = searchPhoto('널뛰기');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('국화전')) {
                    const photo = searchPhoto('국화전');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('칠석과일')) {
                    const photo = searchPhoto('칠석과일');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('백중떡')) {
                    const photo = searchPhoto('백중떡');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('상달고사')) {
                    const photo = searchPhoto('상달고사');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('김장')) {
                    const photo = searchPhoto('김장');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('차례')) {
                    const photo = searchPhoto('차례');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('성묘')) {
                    const photo = searchPhoto('성묘');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('청명') && (lowerQuestion.includes('나들이') || lowerQuestion.includes('놀이'))) {
                    const photo = searchPhoto('청명나들이');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('유두목욕')) {
                    const photo = searchPhoto('유두목욕');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('칠석기원')) {
                    const photo = searchPhoto('칠석기원');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('백중공양')) {
                    const photo = searchPhoto('백중공양');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('중양절') && (lowerQuestion.includes('등고') || lowerQuestion.includes('등산'))) {
                    const photo = searchPhoto('중양절등고');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('상달김장')) {
                    const photo = searchPhoto('상달김장');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('납월제사')) {
                    const photo = searchPhoto('납월제사');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                if (lowerQuestion.includes('섣달그믐')) {
                    const photo = searchPhoto('섣달그믐');
                    const searchLink = generateImageSearchLink(photo.searchTerms);
                    return `📸 ${photo.description}\n\n🔍 사진에서 볼 수 있는 것들: ${photo.visualElements.join(', ')}\n📍 장소: ${photo.location}\n📅 시기: ${photo.season}\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                // 일반적인 세시풍속 사진 검색
                if (lowerQuestion.includes('세시풍속')) {
                    const searchLink = generateImageSearchLink('한국 세시풍속 전통명절');
                    return `📸 한국 세시풍속 사진을 찾아드릴게요!\n\n🔍 볼 수 있는 것들: 전통명절, 전통놀이, 전통음식, 전통의상 등\n📍 장소: 전국 각지\n📅 시기: 연중\n\n🔗 사진을 보려면 여기를 클릭하세요: ${searchLink}`;
                }
                
                // 복조리 사진 요청
                if (lowerQuestion.includes('복조리')) {
                    const searchLinks = generateRealTimeSearchLinks('복조리');
                    return `죄송합니다. "복조리"에 대한 사진 자료는 아직 학습되지 않았습니다.\n\n🔍 실시간 검색을 통해 찾아보세요:\n\n📱 구글 검색:\n- 일반 검색: ${searchLinks.google}\n- 이미지 검색: ${searchLinks.googleImage}\n\n🇰🇷 네이버 검색:\n- 일반 검색: ${searchLinks.naver}\n- 이미지 검색: ${searchLinks.naverImage}\n\n💡 추천 검색어: "복조리 사진", "복조리 이미지", "복조리 전통"\n\n📸 학습된 세시풍속 사진들:\n🎯 전통놀이: 달집태우기, 윷놀이, 강강술래, 그네뛰기, 연날리기, 씨름, 제기차기, 팽이치기, 널뛰기\n🍽️ 전통음식: 송편, 떡국, 오곡밥, 부럼, 귀밝이술, 화전, 수리취떡, 팥죽, 한과, 약과, 국화전, 칠석과일, 백중떡, 김장\n🎭 전통풍습: 지신밟기, 상달고사, 차례, 성묘, 유두목욕, 칠석기원, 백중공양, 상달김장, 납월제사, 섣달그믐\n👗 전통의상: 한복\n🌟 전체: 세시풍속`;
                }
                
                // 학습되지 않은 세시풍속에 대한 실시간 검색 제공
                const searchLinks = generateRealTimeSearchLinks(question);
                return `죄송합니다. "${question}"에 대한 사진 자료는 아직 학습되지 않았습니다.\n\n🔍 실시간 검색을 통해 찾아보세요:\n\n📱 구글 검색:\n- 일반 검색: ${searchLinks.google}\n- 이미지 검색: ${searchLinks.googleImage}\n\n🇰🇷 네이버 검색:\n- 일반 검색: ${searchLinks.naver}\n- 이미지 검색: ${searchLinks.naverImage}\n\n💡 추천 검색어: "${question} 사진", "${question} 이미지", "${question} 전통"\n\n📸 학습된 세시풍속 사진들:\n🎯 전통놀이: 달집태우기, 윷놀이, 강강술래, 그네뛰기, 연날리기, 씨름, 제기차기, 팽이치기, 널뛰기\n🍽️ 전통음식: 송편, 떡국, 오곡밥, 부럼, 귀밝이술, 화전, 수리취떡, 팥죽, 한과, 약과, 국화전, 칠석과일, 백중떡, 김장\n🎭 전통풍습: 지신밟기, 상달고사, 차례, 성묘, 유두목욕, 칠석기원, 백중공양, 상달김장, 납월제사, 섣달그믐\n👗 전통의상: 한복\n🌟 전체: 세시풍속`;
            }

            // 강강술래 관련 (다양한 표현 포함)
            if (lowerQuestion.includes('강강술래') || lowerQuestion.includes('강강수래')) {
                if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('추'))) {
                    return `강강술래는 추석에 여자들이 손을 잡고 빙빙 돌면서 노래를 부르는 놀이예요. 농사를 잘 지어서 곡식이 많이 나오게 해달라고 기원하는 거예요. 그리고 옛날 여자들이 자유롭게 친구들과 만나서 즐겁게 노는 시간이었어요. 다같이 손을 잡고 빙빙 돌면서 노래를 부르니까 마음도 시원하고 즐거워졌대요. 지금도 전통 문화로 소중하게 전해지고 있어요.`;
                }
                if (lowerQuestion.includes('유래') || lowerQuestion.includes('어디서') || lowerQuestion.includes('기원')) {
                    return `강강술래를 하는 이유
🌙 추석 밤 달맞이
: 추석 밤에 밝은 달 아래에서 여자들이 모여 손을 잡고 빙빙 돌면서 농사가 잘 되게 해달라고 기도해요.
🎵 노래와 춤의 즐거움
: 한 사람이 노래를 부르면 다른 사람들이 따라 부르면서 즐겁게 놀아요.
🏛️ 전통 문화 보호
: 지금은 유네스코 세계 문화 유산으로 지정되어서 우리나라의 소중한 전통 문화로 보호받고 있어요.`;
                }
                return '강강술래는 추석 밤에 여자들이 손을 잡고 빙빙 돌면서 노래를 부르는 놀이예요. 농사가 잘 되게 해달라고 기원하는 의미가 있어요. 우리나라의 소중한 전통 문화로 유네스코 문화유산으로도 지정되어 있답니다. 더 자세한 이야기가 궁금하면 "강강술래 유래"라고 물어보세요!';
            }
            
            // 설날 관련
            if (lowerQuestion.includes('설날')) {
                if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('지내'))) {
                    return `🎊 설날을 왜 지내는가?

🌅 새로운 시작:
• 새해의 첫날로 새로운 한 해의 시작을 기념하는 의미
• 과거의 모든 것을 정리하고 새로운 마음으로 새해를 시작
• 희망과 기대를 가지고 새로운 목표를 세우는 시간

👨‍👩‍👧‍👦 가족의 화합:
• 평소 각자 바쁘게 살아온 가족들이 한자리에 모이는 소중한 시간
• 세대 간의 소통과 유대감을 강화하는 기회
• 조상과 후손이 함께 모여 가문의 정체성을 확인

🙏 조상 공경:
• 차례를 지내며 조상님들께 감사와 존경을 표현
• 조상의 덕을 기리고 후손들이 잘 살도록 보살펴달라고 기원
• 효의 정신을 실천하는 중요한 시간

🌾 농업과 자연:
• 농경사회에서 자연의 순환과 농사의 시작을 기념
• 풍년을 기원하고 자연의 은혜에 감사
• 자연과 조화롭게 살아가는 지혜를 배움

🎮 전통 놀이와 문화:
• 윷놀이, 연날리기, 널뛰기 등 전통 놀이를 통해 즐거움을 나눔
• 우리 전통 문화를 체험하고 계승하는 시간
• 세대를 넘나드는 문화적 소통의 장`;
                }
                if (lowerQuestion.includes('떡국') && (lowerQuestion.includes('이유') || lowerQuestion.includes('왜'))) {
                    return `떡국을 먹는 이유
🎂 나이를 한 살 더 먹기 위해서
: 옛날 사람들은 "떡국을 먹어야 한 살 더 먹는다"고 생각했어요.
⚪ 하얀 떡의 의미
: 하얀 떡은 깨끗하고 순수한 마음을 뜻해요.
📏 가래떡의 의미
: 길이가 긴 가래떡을 이용한 요리인 떡국은 오래오래 건강하게 살자는 의미가 있어요.
🪙 둥근 모양의 의미
: 옛날에는 떡국을 먹는 사람이 부자가 되고, 새해 태양의 기운을 받으라는 뜻으로 떡국에 넣는 가래떡을 조상들이 썼던 돈인 엽전과 태양의 모양처럼 동그랗게 썰었어요.`;
                }
                if (lowerQuestion.includes('설빔') && (lowerQuestion.includes('왜') || lowerQuestion.includes('이유') || lowerQuestion.includes('입'))) {
                    return `설빔을 입는 이유
✨ 새해를 깨끗하게 시작하기 위해서
: 묵은 해의 나쁜 것은 버리고 새 옷처럼 깨끗하게 새해를 시작한다는 의미가 있어요.
🍀 복을 받기 위해서
: 새 옷을 입으면 복이 많이 온다고 믿었어요. 예쁘고 깨끗한 옷을 입고 세배를 하면 더 좋은 덕담을 들을 수 있었어요.
👘 전통 문화를 소중히 여기기 위해서
: 설빔은 주로 한복이에요. 색깔도 예쁘고 모양도 아름다운 우리 전통 옷을 입으면서 우리 문화를 소중히 여기는 마음도 생겨요.`;
                }
                if (lowerQuestion.includes('차례상') || (lowerQuestion.includes('차례') && (lowerQuestion.includes('음식') || lowerQuestion.includes('올리') || lowerQuestion.includes('뭐')))) {
                    return `차례상에 올리는 음식
🍲 떡국
: 설날의 가장 중요한 음식이에요. 흰 떡국을 조상님께도 올려드려요.
🥬 여러 가지 나물
: 시금치나물, 도라지나물, 고사리나물 같은 여러 가지 나물을 올려요. 색깔도 예쁘고 영양도 좋아요.
🐟 생선과 고기
: 북어나 명태 같은 생선과 소고기로 만든 음식을 올려요. 정성스럽게 준비한 음식들이에요.
🥞 전과 적
: 부침개처럼 밀가루나 고기를 부쳐서 만든 전을 올려요. 동그랗게 지진 전이 예뻐요.
🍎 과일
: 사과, 배, 감 같은 제철 과일을 올려요. 예쁘게 담아서 올린답니다.
🍯 한과와 약과
: 달콤한 한과와 약과도 올려요. 조상님들께 맛있는 것을 드리려는 마음이에요.`;
                }
                if (lowerQuestion.includes('유래') || lowerQuestion.includes('어떻게')) {
                    return '설날은 농경사회에서 새해의 시작을 기념하는 의미로 시작되었습니다. 조상들이 자연의 순환에 따라 새해를 맞이하며 가족의 화합과 풍년을 기원하는 마음에서 비롯되었습니다.';
                }
                // 설날 질문 문맥 분석
                // 1. 음식 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('먹')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('먹')) ||
                    lowerQuestion.includes('무슨 음식') || lowerQuestion.includes('음식을') ||
                    (lowerQuestion.includes('음식') && (lowerQuestion.includes('뭐') || lowerQuestion.includes('무엇')))) {
                    return `🍜 떡국: 가래떡으로 만들어요.
🍬 강정: 찹쌀로 만든 과자예요.
🍵 수정과: 시원한 음료예요. 세찬이라고 불러요.`;
                }
                
                // 2. 하는 일 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('해')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('해')) ||
                    lowerQuestion.includes('무슨 일') || lowerQuestion.includes('하는 일')) {
                    return `🙏 차례: 조상님께 차례를 지내요. 차례상에 떡국, 나물, 생선, 전, 과일, 강정을 올려요.
🙏 세배: 어른들께 절을 하며 인사해요. 덕담을 들어요. 세뱃돈을 받아요.
🎊 복 바라기: 복조리는 복을 담는 용기를 걸어요. 복주머니는 복이 오라고 차요. 세화, 문배는 문에 붙여서 나쁜 일을 막아요. 야광귀는 신발을 감춰서 신발 도둑 귀신을 막아요.`;
                }
                
                // 3. 복장 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('입')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('입')) ||
                    lowerQuestion.includes('무슨 옷') || lowerQuestion.includes('복장')) {
                    return `👗 설빔: 새 옷을 입어요. 한복이나 좋은 옷을 입어요.`;
                }
                
                // 4. 일반적인 명절 설명 (뭐야, 무엇인가 등)
                if (lowerQuestion.includes('뭐야') || lowerQuestion.includes('무엇') || lowerQuestion.includes('의미') || lowerQuestion.includes('뜻')) {
                    return `설날은 음력 1월 1일로 한 해가 시작되는 아주 중요한 날이에요. 새해의 첫날로 온 가족이 모여 화합하고 새해의 복을 기원하는 가장 중요한 명절이에요.`;
                }
                
                // 설날에 하는 일 질문
                if (lowerQuestion.includes('하') || lowerQuestion.includes('일') || lowerQuestion.includes('뭘 해') || lowerQuestion.includes('뭐 해') || lowerQuestion.includes('무슨 일을 해') || lowerQuestion.includes('하는 일이 뭐야')) {
                    return `🙏 차례: 조상님께 차례를 지내요. 차례상에 떡국, 나물, 생선, 전, 과일, 강정을 올려요.
🙏 세배: 어른들께 절을 하며 인사해요. 덕담을 들어요. 세뱃돈을 받아요.
🎊 복 바라기: 복조리는 복을 담는 용기를 걸어요. 복주머니는 복이 오라고 차요. 세화, 문배는 문에 붙여서 나쁜 일을 막아요. 야광귀는 신발을 감춰서 신발 도둑 귀신을 막아요.`;
                }
                
                // 설날에 입는 옷 질문
                if (lowerQuestion.includes('입') || lowerQuestion.includes('옷') || lowerQuestion.includes('뭐 입') || lowerQuestion.includes('무슨 옷') || lowerQuestion.includes('복장')) {
                    return `👗 설빔: 새 옷을 입어요. 한복이나 좋은 옷을 입어요.`;
                }
                
                // 설날에 하는 놀이 질문
                if (lowerQuestion.includes('놀이')) {
                    return `🎮 윷놀이: 운세를 점쳐요.
🪁 연날리기: 나쁜 기운을 날려보내요.
🏃‍♀️ 널뛰기, 제기차기, 팽이치기도 해요.`;
                }
                
                // 기본 설날 설명
                return `설날은 음력 1월 1일로 한 해가 시작되는 아주 중요한 날이에요. 새해의 첫날로 온 가족이 모여 화합하고 새해의 복을 기원하는 가장 중요한 명절이에요.`;
            }
            
            // 단오 관련 문맥 분석
            if (lowerQuestion.includes('단오')) {
                if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('지내'))) {
                    return `단오를 지내는 이유
☀️ 여름의 시작
: 음력 5월 5일로 여름이 본격적으로 시작되는 시점이에요.
🏥 건강과 액운 예방
: 창포로 머리를 감아 여름철 질병을 예방하고 수리취떡을 먹어 몸의 독을 제거해요.
🎮 전통 놀이와 운동
: 그네뛰기로 여성들의 건강과 아름다움을 기원하고 씨름으로 남성들의 힘과 용맹함을 겨뤄요.`;
                }
                // 구체적인 질문들 처리
                if (lowerQuestion.includes('그네') && (lowerQuestion.includes('타') || lowerQuestion.includes('뛰') || lowerQuestion.includes('놀이'))) {
                    return '네, 단오에는 그네뛰기를 합니다. 그네뛰기는 단오의 대표 놀이로, 여성들이 그네에 올라가서 앞뒤로 흔들리는 놀이입니다.';
                }
                
                if (lowerQuestion.includes('창포') && (lowerQuestion.includes('머리') || lowerQuestion.includes('감') || lowerQuestion.includes('씻'))) {
                    return '네, 단오에는 창포로 머리를 감습니다. 창포는 단오에 창포물에 머리를 감는 풍습으로, 머리를 깨끗하게 하고 건강을 기원하는 의미가 있습니다.';
                }
                
                if (lowerQuestion.includes('수리취떡') && (lowerQuestion.includes('먹') || lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                    return '네, 단오에는 수리취떡을 먹습니다. 수리취떡은 단오에 먹는 전통 떡으로, 수리취 잎으로 감싸서 만들어 여름의 건강을 기원하는 의미가 있습니다.';
                }
                
                if (lowerQuestion.includes('유래') || lowerQuestion.includes('어떻게')) {
                    return '단오는 중국에서 전래된 명절로, 우리나라에서는 여름의 대표적인 명절로 발전했습니다. 여름의 시작과 건강, 액운을 쫓는 의미로 행해집니다.';
                }
                
                // 단오 질문 문맥 분석
                // 1. 음식 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('먹')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('먹')) ||
                    lowerQuestion.includes('무슨 음식') || lowerQuestion.includes('음식을') ||
                    (lowerQuestion.includes('음식') && (lowerQuestion.includes('뭐') || lowerQuestion.includes('무엇')))) {
                    return `🍲 수리취떡: 건강해지고 나쁜 일을 막아요.
🍒 앵두화채: 시원한 음료예요.`;
                }
                
                // 2. 하는 일 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('해')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('해')) ||
                    lowerQuestion.includes('무슨 일') || lowerQuestion.includes('하는 일')) {
                    return `🌿 머리 손질: 창포물로 머리를 감아요. 나쁜 귀신을 막아요.
🎁 부채 선물: 부채를 선물해요. 더운 여름을 시원하게 보내라는 의미예요.
🌳 대추나무시집보내기: 대추나무를 도끼로 두드려요. 대추가 많이 열리게 해요.`;
                }
                
                // 3. 복장 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('입')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('입')) ||
                    lowerQuestion.includes('무슨 옷') || lowerQuestion.includes('복장')) {
                    return `👗 단오빔: 새 옷을 입어요. 시원한 모시옷을 입어서 여름을 잘 보내요.`;
                }
                
                // 4. 일반적인 명절 설명 (뭐야, 무엇인가 등)
                if (lowerQuestion.includes('뭐야') || lowerQuestion.includes('무엇') || lowerQuestion.includes('의미') || lowerQuestion.includes('뜻')) {
                    return `단오는 음력 5월 5일로 여름의 중요한 명절이에요. '수릿날'이라고도 불러요. 여름이 본격적으로 시작되는 시점으로 여름철 건강을 미리 준비하고 더위를 이기기 위한 준비를 하는 날이에요.`;
                }
                
                // 단오에 하는 일 질문
                if (lowerQuestion.includes('하') || lowerQuestion.includes('일') || lowerQuestion.includes('뭘 해') || lowerQuestion.includes('뭐 해') || lowerQuestion.includes('무슨 일을 해') || lowerQuestion.includes('하는 일이 뭐야')) {
                    return `🌿 머리 손질: 창포물로 머리를 감아요. 나쁜 귀신을 막아요.
🎁 부채 선물: 부채를 선물해요. 더운 여름을 시원하게 보내라는 의미예요.
🌳 대추나무시집보내기: 대추나무를 도끼로 두드려요. 대추가 많이 열리게 해요.`;
                }
                
                // 단오에 입는 옷 질문
                if (lowerQuestion.includes('입') || lowerQuestion.includes('옷') || lowerQuestion.includes('뭐 입') || lowerQuestion.includes('무슨 옷') || lowerQuestion.includes('복장')) {
                    return `👗 단오빔: 새 옷을 입어요. 시원한 모시옷을 입어서 여름을 잘 보내요.`;
                }
                
                // 단오에 하는 놀이 질문
                if (lowerQuestion.includes('놀이')) {
                    return `🎮 그네뛰기: 여자들이 높이 타요. 모기에 안 물리고 더위를 안 타요.
🤼 씨름: 남자들이 힘을 겨뤄요.`;
                }
                
                // 기본 단오 설명
                return `단오는 음력 5월 5일로 여름의 중요한 명절이에요. '수릿날'이라고도 불러요. 여름이 본격적으로 시작되는 시점으로 여름철 건강을 미리 준비하고 더위를 이기기 위한 준비를 하는 날이에요.`;
            }
            
            // 추석 관련 문맥 분석
            if (lowerQuestion.includes('추석')) {
                if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('지내'))) {
                    return `추석을 지내는 이유
🌾 수확의 감사
: 한 해 농사 수확을 마치고 그 풍성함에 감사하는 시간이에요.
👨‍👩‍👧‍👦 가족의 화합
: 일 년 중 가장 풍성한 시기에 온 가족이 모이는 소중한 시간이에요.
🙏 조상 공경
: 조상님들께 풍성한 수확의 기쁨을 함께 나누는 의미예요.`;
                }
                // 추석에 특정 음식 먹는지 질문하는 경우
                if (lowerQuestion.includes('송편') && (lowerQuestion.includes('먹') || lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                    return '네, 추석에는 송편을 먹습니다. 송편은 추석에 빚는 전통 떡으로, 둥근 모양이 보름달을 상징하여 가족의 화합과 풍년을 기원하는 의미가 있습니다.';
                }
                if (lowerQuestion.includes('떡국') && (lowerQuestion.includes('먹') || lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                    const searchLinks = generateRealTimeSearchLinks(question);
                    return `죄송합니다. "추석에 떡국을 먹나요?"에 대한 정보는 아직 학습되지 않았습니다.\n\n🔍 실시간 검색을 통해 찾아보세요:\n\n📱 구글: ${searchLinks.google}\n🇰🇷 네이버: ${searchLinks.naver}\n📷 네이버 이미지: ${searchLinks.naverImage}\n\n💡 추천 검색어: "추석 떡국", "추석 전통 음식", "추석과 떡국"\n\n📝 알고 있는 정보: 떡국은 일반적으로 설날에 먹는 전통 음식입니다.`;
                }
                
                if (lowerQuestion.includes('유래') || lowerQuestion.includes('어떻게')) {
                    return '추석은 농경사회에서 추수를 감사하는 의미로 시작된 명절입니다. 가을 수확을 감사하고 조상에게 감사하는 마음에서 비롯되었습니다.';
                }
                // 추석 질문 문맥 분석
                // 1. 음식 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('먹')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('먹')) ||
                    lowerQuestion.includes('무슨 음식') || lowerQuestion.includes('음식을') ||
                    (lowerQuestion.includes('음식') && (lowerQuestion.includes('뭐') || lowerQuestion.includes('무엇')))) {
                    return `🍲 송편: 햇곡식으로 만들어요.
🍲 토란국: 소화가 잘 되게 해요.
🍎 햇과일도 먹어요.`;
                }
                
                // 2. 하는 일 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('해')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('해')) ||
                    lowerQuestion.includes('무슨 일') || lowerQuestion.includes('하는 일')) {
                    return `🙏 차례와 성묘: 조상님께 차례를 지내요. 산소에 가서 성묘도 해요. 햇곡식과 햇과일로 수확을 감사해요.
🌕 달맞이: 보름달을 보며 소원을 빌어요. 먹을거리가 가장 풍성한 때예요.
🏠 귀성: 고향에 계신 부모님을 만나러 가요.`;
                }
                
                // 3. 복장 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('입')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('입')) ||
                    lowerQuestion.includes('무슨 옷') || lowerQuestion.includes('복장')) {
                    return `👗 추석빔: 새 옷을 입어요. 가을 겨울용 옷을 준비해요.`;
                }
                
                // 4. 일반적인 명절 설명 (뭐야, 무엇인가 등)
                if (lowerQuestion.includes('뭐야') || lowerQuestion.includes('무엇') || lowerQuestion.includes('의미') || lowerQuestion.includes('뜻')) {
                    return `추석은 음력 8월 15일로 '한가위'라고도 불러요. 일 년 중 가장 풍성한 명절이에요. 한 해 농사 수확을 마치고 그 풍성함에 감사하는 시간이에요.`;
                }
                
                // 추석에 하는 일 질문
                if (lowerQuestion.includes('하') || lowerQuestion.includes('일') || lowerQuestion.includes('뭘 해') || lowerQuestion.includes('뭐 해') || lowerQuestion.includes('무슨 일을 해') || lowerQuestion.includes('하는 일이 뭐야')) {
                    return `🙏 차례와 성묘: 조상님께 차례를 지내요. 산소에 가서 성묘도 해요. 햇곡식과 햇과일로 수확을 감사해요.
🌕 달맞이: 보름달을 보며 소원을 빌어요. 먹을거리가 가장 풍성한 때예요.
🏠 귀성: 고향에 계신 부모님을 만나러 가요.`;
                }
                
                // 추석에 입는 옷 질문
                if (lowerQuestion.includes('입') || lowerQuestion.includes('옷') || lowerQuestion.includes('뭐 입') || lowerQuestion.includes('무슨 옷') || lowerQuestion.includes('복장')) {
                    return `👗 추석빔: 새 옷을 입어요. 가을 겨울용 옷을 준비해요.`;
                }
                
                // 추석에 하는 놀이 질문
                if (lowerQuestion.includes('놀이')) {
                    return `🎮 강강술래: 여자들이 손잡고 빙빙 돌며 노래해요.
🐄 소놀이: 소와 농부를 위로해요.
🧵 길쌈놀이: 누가 베를 잘 짰는지 겨뤄요.
🎯 꼬리따기, 문지기놀이: 아이들이 재미있게 놀아요.`;
                }
                
                // 기본 추석 설명
                return `추석은 음력 8월 15일로 '한가위'라고도 불러요. 일 년 중 가장 풍성한 명절이에요. 한 해 농사 수확을 마치고 그 풍성함에 감사하는 시간이에요.`;
            }
            
            // 정월대보름 풍습 "왜 하는지" 질문 처리
            if (lowerQuestion.includes('달집태우기') && (lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                return `달집태우기를 하는 이유
🔥 나쁜 기운을 태워요
: 달집에 불을 붙여서 나쁜 기운과 액운을 모두 태워버려요. 큰 불로 태우면 나쁜 것들이 다 없어진다고 믿었어요.
🌾 농사가 잘 되기를 바라요
: 불을 태우면서 한 해 농사가 잘 되기를 기원했어요. 풍년을 바라는 마음을 담아서 큰 불을 태웠답니다.
🎊 복을 받아요
: 나쁜 기운을 태우면 좋은 기운과 복이 들어온다고 믿었어요.`;
            }
            
            if (lowerQuestion.includes('쥐불놀이') && (lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                return `쥐불놀이를 하는 이유
🐭 쥐를 쫓아내요
: 논밭에 불을 질러서 해로운 쥐들을 쫓아내요. 쥐가 곡식을 먹지 못하게 하려는 거예요.
🦗 해충을 없애요
: 불을 붙이면 땅 속의 해충과 벌레들도 없어져요. 농사에 해로운 것들을 미리 없애는 거예요.
🌾 농사 준비를 해요
: 겨울 동안 논밭에 남아있던 지푸라기를 태우면서 새로운 농사를 준비했어요.`;
            }
            
            if (lowerQuestion.includes('다리밟기') && (lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                return `다리밟기를 하는 이유
🦵 다리가 튼튼해져요
: 다리를 밟으면 일 년 동안 다리에 병이 나지 않고 튼튼해진다고 믿었어요.
🌉 여러 번 밟아요
: 다리를 열두 번 밟으면 일 년 열두 달 동안 건강하다고 했어요.
👥 함께 건너요
: 가족이나 친구들과 함께 다리를 건너면서 즐거운 시간을 보냈어요.`;
            }
            
            // 정월대보름 관련 문맥 분석
            if (lowerQuestion.includes('정월대보름') || lowerQuestion.includes('대보름')) {
                if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('지내'))) {
                    return `정월대보름을 지내는 이유
🌙 보름달의 의미
: 정월의 첫 보름달을 맞이하며 한 해의 시작을 축복해요.
🔥 액운 제거와 소원 기원
: 달집태우기로 나쁜 기운을 태워 없애고 부럼을 깨물며 부스럼이 생기지 않도록 기원해요.
🌾 농업과 풍년
: 오곡밥을 먹어 다섯 가지 곡식의 풍성한 수확을 기원해요.`;
                }
                // 구체적인 질문들 처리
                if (lowerQuestion.includes('눈썹') && (lowerQuestion.includes('하얘') || lowerQuestion.includes('하얗') || lowerQuestion.includes('하얀'))) {
                    const searchLinks = generateRealTimeSearchLinks(question);
                    return `죄송합니다. "정월대보름에 눈썹이 하얘지나요?"에 대한 정보는 아직 학습되지 않았습니다.\n\n🔍 실시간 검색을 통해 찾아보세요:\n\n📱 구글: ${searchLinks.google}\n🇰🇷 네이버: ${searchLinks.naver}\n📷 네이버 이미지: ${searchLinks.naverImage}\n\n💡 추천 검색어: "정월대보름 눈썹", "대보름 눈썹", "눈썹 하얘지는 이유"\n\n📝 알고 있는 정보: 정월대보름에는 여러 전통 풍습이 있습니다.`;
                }
                
                if (lowerQuestion.includes('부럼') && (lowerQuestion.includes('먹') || lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                    return `부럼을 깨무는 이유
1. 이빨을 튼튼하게 하기 위해서
: 딱딱한 견과류를 깨물어 이빨을 튼튼하게 하는 의미가 있어요.
2. 부스럼을 막기 위해서
: 부스럼(피부가 빨갛게 되거나 부어오르는 증상)이 생기지 말라는 바람이 담겨 있어요.
3. 건강을 기원하기 위해서
: 견과류의 영양소로 건강을 지키고 액운을 예방하는 의미가 있어요.`;
                }
                
                if (lowerQuestion.includes('오곡밥') && (lowerQuestion.includes('먹') || lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                    return `오곡밥은 정월대보름에 먹는 특별한 밥이에요.

🌾 농사가 잘 되기를 바라요
다섯 가지 곡식으로 만든 밥을 먹으면서 한 해 농사가 잘 되어서 곡식이 풍성하기를 기원했어요.

🍚 다섯 가지 곡식
쌀, 찹쌀, 팥, 콩, 조 같은 다섯 가지 곡식을 섞어서 밥을 지어요. 여러 가지 곡식이 들어가서 영양도 좋아요.

💪 건강해져요
여러 곡식의 영양을 골고루 먹어서 건강해진다고 믿었어요.`;
                }
                
                if (lowerQuestion.includes('귀밝이술') && (lowerQuestion.includes('마시') || lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                    return '네, 정월대보름에는 귀밝이술을 마십니다. 귀밝이술은 정월대보름에 마시는 술로, 귀가 밝아져서 좋은 소식만 들리기를 기원하는 의미가 있습니다.';
                }
                
                // 정월대보름 질문 문맥 분석
                // 1. 음식 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('먹')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('먹')) ||
                    lowerQuestion.includes('무슨 음식') || lowerQuestion.includes('음식을') ||
                    (lowerQuestion.includes('음식') && (lowerQuestion.includes('뭐') || lowerQuestion.includes('무엇')))) {
                    return `🥜 부럼: 이가 튼튼해지고 피부병이 안 생겨요.
🍚 오곡밥: 농사가 잘 되기를 바라요.
🍯 약밥: 달콤한 밥이에요.
🥬 나물: 아홉 가지 나물을 먹어요.
🍶 귀밝이술: 귀가 밝아지고 좋은 소식을 들어요.`;
                }
                
                // 2. 하는 일 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('해')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('해')) ||
                    lowerQuestion.includes('무슨 일') || lowerQuestion.includes('하는 일')) {
                    return `🌕 달맞이: 보름달을 보며 소원을 빌어요. 농사가 잘 되기를 바라요.
🔥 달집태우기: 큰 불을 태워 나쁜 기운을 쫓아내요.
🌳 가수: 과일나무에 돌을 끼워 열매가 많이 열리게 해요.
🏠 지신밟기: 집터를 지켜주는 지신을 달래요. 마을 사람들이 집마다 돌며 지신을 밟아서 달래는 풍속이에요. 풍물놀이도 함께 하며 마을과 가정의 안녕을 기원해요.`;
                }
                
                // 3. 복장 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('입')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('입')) ||
                    lowerQuestion.includes('무슨 옷') || lowerQuestion.includes('복장')) {
                    return '정월대보름에는 특별히 입는 옷이 없어요. 보통 겨울 옷을 입고 지냈어요.';
                }
                
                // 4. 일반적인 명절 설명 (뭐야, 무엇인가 등)
                if (lowerQuestion.includes('뭐야') || lowerQuestion.includes('무엇') || lowerQuestion.includes('의미') || lowerQuestion.includes('뜻')) {
                    return `정월대보름은 음력 1월 15일로, 새해 처음으로 보름달이 뜨는 날이에요. 정월의 첫 보름달을 맞이하며 한 해의 시작을 축복하는 날이에요.`;
                }
                
                // 정월대보름에 하는 일 질문
                if (lowerQuestion.includes('하') || lowerQuestion.includes('일') || lowerQuestion.includes('뭘 해') || lowerQuestion.includes('뭐 해') || lowerQuestion.includes('무슨 일을 해') || lowerQuestion.includes('하는 일이 뭐야')) {
                    return `🌕 달맞이: 보름달을 보며 소원을 빌어요. 농사가 잘 되기를 바라요.
🔥 달집태우기: 큰 불을 태워 나쁜 기운을 쫓아내요.
🌳 가수: 과일나무에 돌을 끼워 열매가 많이 열리게 해요.
🏠 지신밟기: 집터를 지켜주는 지신을 달래요. 마을 사람들이 집마다 돌며 지신을 밟아서 달래는 풍속이에요. 풍물놀이도 함께 하며 마을과 가정의 안녕을 기원해요.`;
                }
                
                // 정월대보름에 입는 옷 질문
                if (lowerQuestion.includes('입') || lowerQuestion.includes('옷') || lowerQuestion.includes('뭐 입') || lowerQuestion.includes('무슨 옷') || lowerQuestion.includes('복장')) {
                    return '정월대보름에는 특별히 입는 옷이 없어요. 보통 겨울 옷을 입고 지냈어요.';
                }
                
                // 정월대보름에 하는 놀이 질문
                if (lowerQuestion.includes('놀이')) {
                    return `🎮 줄다리기: 밧줄을 당겨서 승부를 겨뤄요. 이기면 풍년이에요.
🌾 고싸움: 볏짚 고를 밀어붙여요.
🏃‍♀️ 다리밟기: 다리를 밟으면 다리가 튼튼해져요.`;
                }
                
                // 기본 정월대보름 설명
                return `정월대보름은 음력 1월 15일로, 새해 처음으로 보름달이 뜨는 날이에요. 정월의 첫 보름달을 맞이하며 한 해의 시작을 축복하는 날이에요.`;
            }
            
            // 동지 관련 문맥 분석
            if (lowerQuestion.includes('동지')) {
                if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('지내'))) {
                    return `동지를 지내는 이유
🌙 밤과 낮의 전환점
: 일년 중 밤이 가장 긴 날로, 자연의 순환에서 중요한 전환점이에요.
🔥 겨울의 극한과 새로운 희망
: 가장 어둡고 추운 시기를 극복하며 새로운 희망을 품어요.
🏥 건강과 액운 예방
: 팥죽을 먹어 겨울철 질병을 예방하고 건강을 기원해요.`;
                }
                // 구체적인 질문들 처리
                if (lowerQuestion.includes('팥죽') && (lowerQuestion.includes('먹') || lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                    return '네, 동지에는 팥죽을 먹습니다. 팥죽은 동지에 먹는 전통 음식으로, 팥의 빨간색이 악귀를 쫓는다고 믿어 액운을 막고 건강을 기원하는 의미가 있습니다.';
                }
                
                if (lowerQuestion.includes('밤') && (lowerQuestion.includes('긴') || lowerQuestion.includes('길') || lowerQuestion.includes('가장'))) {
                    return '네, 동지는 일년 중 밤이 가장 긴 날입니다. 동지 이후부터는 낮이 점점 길어지기 시작하여 새로운 시작을 의미하는 날입니다.';
                }
                
                // 동지 질문 문맥 분석
                // 1. 음식 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('먹')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('먹')) ||
                    lowerQuestion.includes('무슨 음식') || lowerQuestion.includes('음식을') ||
                    (lowerQuestion.includes('음식') && (lowerQuestion.includes('뭐') || lowerQuestion.includes('무엇')))) {
                    return `🍲 팥죽: 팥죽에 새알심을 넣어요.
새알심: 나이 수만큼 먹으면 한 살 더 먹어요.`;
                }
                
                // 2. 하는 일 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('해')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('해')) ||
                    lowerQuestion.includes('무슨 일') || lowerQuestion.includes('하는 일')) {
                    return `팥죽뿌리기: 집안에 뿌려서 나쁜 귀신을 막아요. 팥의 붉은색을 귀신이 싫어해요.

📅 동지책력: 새해 달력을 선물해요. 농사를 잘 짓기 위해 달력이 중요했어요.

🌾 새해 준비: 한 해를 마무리하고 새해를 맞이할 준비를 해요. 나쁜 일을 막고 좋은 일이 많기를 바라요.`;
                }
                
                // 3. 복장 관련 질문
                if ((lowerQuestion.includes('뭐') && lowerQuestion.includes('입')) || 
                    (lowerQuestion.includes('뭘') && lowerQuestion.includes('입')) ||
                    lowerQuestion.includes('무슨 옷') || lowerQuestion.includes('복장')) {
                    return '동지에는 특별히 입는 옷이 없어요. 보통 겨울 옷을 입고 지냈어요.';
                }
                
                // 4. 일반적인 명절 설명 (뭐야, 무엇인가 등)
                if (lowerQuestion.includes('뭐야') || lowerQuestion.includes('무엇') || lowerQuestion.includes('의미') || lowerQuestion.includes('뜻')) {
                return `동지는 24절기 중 하나로 일 년 중 밤이 가장 길고 낮이 가장 짧은 날이에요. 보통 양력 12월 22일경이에요.

🌙 아세: '작은 설'이라는 뜻이에요. 동지가 지나면 낮이 점점 길어져서 새해의 시작처럼 여겼어요.`;
                }
                
                // 동지에 하는 일 질문
                if (lowerQuestion.includes('하') || lowerQuestion.includes('일') || lowerQuestion.includes('뭘 해') || lowerQuestion.includes('뭐 해') || lowerQuestion.includes('무슨 일을 해') || lowerQuestion.includes('하는 일이 뭐야')) {
                    return `팥죽뿌리기: 집안에 뿌려서 나쁜 귀신을 막아요. 팥의 붉은색을 귀신이 싫어해요.

📅 동지책력: 새해 달력을 선물해요. 농사를 잘 짓기 위해 달력이 중요했어요.

🌾 새해 준비: 한 해를 마무리하고 새해를 맞이할 준비를 해요. 나쁜 일을 막고 좋은 일이 많기를 바라요.`;
                }
                
                // 동지에 입는 옷 질문
                if (lowerQuestion.includes('입') || lowerQuestion.includes('옷') || lowerQuestion.includes('뭐 입') || lowerQuestion.includes('무슨 옷') || lowerQuestion.includes('복장')) {
                    return '동지에는 특별히 입는 옷이 없어요. 보통 겨울 옷을 입고 지냈어요.';
                }
                
                // 동지에 하는 놀이 질문
                if (lowerQuestion.includes('놀이')) {
                    return '동지에는 특별한 놀이보다는 팥죽을 먹고 새해 준비를 하는 것이 주된 활동이에요.';
                }
                
                // 기본 동지 설명
                return `동지는 24절기 중 하나로 일 년 중 밤이 가장 길고 낮이 가장 짧은 날이에요. 보통 양력 12월 22일경이에요.

🌙 아세: '작은 설'이라는 뜻이에요. 동지가 지나면 낮이 점점 길어져서 새해의 시작처럼 여겼어요.`;
            }
            
            
            // 삼짇날 관련
            if (lowerQuestion.includes('삼짇날') || lowerQuestion.includes('삼월삼일')) {
                const samjinnal = sesiData.spring.festivals.삼짇날;
                return `삼짇날${getKoreanParticle('삼짇날')} ${samjinnal.date}에 지내는 명절로, ${samjinnal.description}입니다. 이 날에는 ${samjinnal.activities.join(', ')} 등의 풍습을 행하며, ${samjinnal.foods.join(', ')} 등을 먹습니다. ${samjinnal.meaning}`;
            }
            
            // 청명 관련
            if (lowerQuestion.includes('청명')) {
                const cheongmyeong = sesiData.spring.festivals.청명;
                return `청명${getKoreanParticle('청명')} ${cheongmyeong.date}에 지내는 명절로, ${cheongmyeong.description}입니다. 이 날에는 ${cheongmyeong.activities.join(', ')} 등의 풍습을 행하며, ${cheongmyeong.foods.join(', ')} 등을 먹습니다. ${cheongmyeong.meaning}`;
            }
            
            // 한식 관련
            if (lowerQuestion.includes('한식')) {
                if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('지내'))) {
                    return `한식을 지내는 이유
🙏 조상 추모
: 조상님들에 대한 깊은 추모와 존경의 마음을 표현해요.
🔥 불 끄기의 의미
: 하루 동안 불을 피우지 않고 찬 음식만 먹어요.
🌱 자연과의 조화
: 봄의 시작을 맞아 자연의 순환에 맞춰 생활해요.`;
                }
                const hansik = sesiData.spring.festivals.한식;
                return `한식${getKoreanParticle('한식')} ${hansik.date}에 지내는 명절로, ${hansik.description}입니다. 이 날에는 ${hansik.activities.join(', ')} 등의 풍습을 행하며, ${hansik.foods.join(', ')} 등을 먹습니다. ${hansik.meaning}`;
            }
            
            // 유두 관련
            if (lowerQuestion.includes('유두')) {
                if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('지내'))) {
                    return `유두를 지내는 이유
☀️ 여름 더위 극복
: 본격적인 여름 더위가 시작되는 시점에서 건강을 준비해요.
🍉 자연의 풍요
: 여름 과일들이 풍성하게 익어나는 시기를 즐겨요.
🏊 물놀이와 놀이
: 더위를 피해 물놀이를 하며 즐거운 시간을 보내요.`;
                }
                const yudu = sesiData.summer.festivals.유두;
                return `유두${getKoreanParticle('유두')} ${yudu.date}에 지내는 명절로, ${yudu.description}입니다. 이 날에는 ${yudu.activities.join(', ')} 등의 풍습을 행하며, ${yudu.foods.join(', ')} 등을 먹습니다. ${yudu.meaning}`;
            }
            
            // 칠석 관련
            if (lowerQuestion.includes('칠석')) {
                if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('지내'))) {
                    return `칠석을 지내는 이유
💫 견우직녀의 전설
: 견우와 직녀가 일 년에 한 번 만나는 로맨틱한 날이에요.
🌟 소원과 기도
: 밤하늘의 별을 바라보며 소원을 빌고 기도하는 시간이에요.
🧵 여성의 재능
: 바느질과 손재주를 기르고 여성의 재능을 발휘하는 날이에요.`;
                }
                const chilseok = sesiData.summer.festivals.칠석;
                return `칠석${getKoreanParticle('칠석')} ${chilseok.date}에 지내는 명절로, ${chilseok.description}입니다. 이 날에는 ${chilseok.activities.join(', ')} 등의 풍습을 행하며, ${chilseok.foods.join(', ')} 등을 먹습니다. ${chilseok.meaning}`;
            }
            
            // 백중 관련
            if (lowerQuestion.includes('백중')) {
                if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('지내'))) {
                    return `백중을 지내는 이유
🙏 부처님 귀환
: 부처님께서 하늘에서 돌아오신 것을 기리는 불교적 의미예요.
🌾 중원의 풍요
: 여름의 끝과 가을의 시작을 알리는 중요한 시점이에요.
👥 공동체 화합
: 마을 사람들이 함께 모여 백중제와 백중놀이를 즐겨요.`;
                }
                const baekjung = sesiData.summer.festivals.백중;
                return `백중${getKoreanParticle('백중')} ${baekjung.date}에 지내는 명절로, ${baekjung.description}입니다. 이 날에는 ${baekjung.activities.join(', ')} 등의 풍습을 행하며, ${baekjung.foods.join(', ')} 등을 먹습니다. ${baekjung.meaning}`;
            }
            
            // 중양절 관련
            if (lowerQuestion.includes('중양절')) {
                if (lowerQuestion.includes('왜') && (lowerQuestion.includes('해') || lowerQuestion.includes('하') || lowerQuestion.includes('지내'))) {
                    return `중양절을 지내는 이유
🌸 국화 감상
: 가을을 대표하는 국화가 만발하는 시기를 즐겨요.
🏔️ 산놀이와 등고
: 산에 올라가 국화를 감상하며 자연과 교감해요.
🏥 건강과 장수
: 국화주와 국화차를 마시며 건강과 장수를 기원해요.`;
                }
                const jungyangjeol = sesiData.autumn.festivals.중양절;
                return `중양절${getKoreanParticle('중양절')} ${jungyangjeol.date}에 지내는 명절로, ${jungyangjeol.description}입니다. 이 날에는 ${jungyangjeol.activities.join(', ')} 등의 풍습을 행하며, ${jungyangjeol.foods.join(', ')} 등을 먹습니다. ${jungyangjeol.meaning}`;
            }
            
            // 상달고사 관련
            if (lowerQuestion.includes('상달고사')) {
                const sangdalgosa = sesiData.autumn.festivals.상달고사;
                return `상달고사${getKoreanParticle('상달고사')} ${sangdalgosa.date}에 지내는 명절로, ${sangdalgosa.description}입니다. 이 날에는 ${sangdalgosa.activities.join(', ')} 등의 풍습을 행하며, ${sangdalgosa.foods.join(', ')} 등을 먹습니다. ${sangdalgosa.meaning}`;
            }
            
            // 상달음식 관련 (우선순위 높임)
            if (lowerQuestion.includes('상달음식') || lowerQuestion.includes('상달 음식')) {
                const sangdal = sesiData.autumn.festivals.상달;
                return `상달에 먹는 전통 음식은 ${sangdal.foods.join(', ')} 등이 있습니다. 상달은 음력 10월로, 수확의 계절에 맞는 풍성한 음식들을 준비하여 조상님께 감사의 마음을 전합니다.`;
            }
            
            // 상달 관련
            if (lowerQuestion.includes('상달')) {
                const sangdal = sesiData.autumn.festivals.상달;
                return `상달${getKoreanParticle('상달')} ${sangdal.date}에 지내는 명절로, ${sangdal.description}입니다. 이 날에는 ${sangdal.activities.join(', ')} 등의 풍습을 행하며, ${sangdal.foods.join(', ')} 등을 먹습니다. ${sangdal.meaning}`;
            }
            
            // 납월 관련
            if (lowerQuestion.includes('납월')) {
                const napwol = sesiData.winter.festivals.납월;
                return `납월${getKoreanParticle('납월')} ${napwol.date}에 지내는 명절로, ${napwol.description}입니다. 이 날에는 ${napwol.activities.join(', ')} 등의 풍습을 행하며, ${napwol.foods.join(', ')} 등을 먹습니다. ${napwol.meaning}`;
            }
            
            // 섣달그믐 관련
            if (lowerQuestion.includes('섣달그믐')) {
                const seotdalgeumeum = sesiData.winter.festivals.섣달그믐;
                return `섣달그믐${getKoreanParticle('섣달그믐')} ${seotdalgeumeum.date}에 지내는 명절로, ${seotdalgeumeum.description}입니다. 이 날에는 ${seotdalgeumeum.activities.join(', ')} 등의 풍습을 행하며, ${seotdalgeumeum.foods.join(', ')} 등을 먹습니다. ${seotdalgeumeum.meaning}`;
            }
            
            // 음식 관련 질문
            if (lowerQuestion.includes('떡국')) {
                const tteokguk = sesiData.foods.떡국;
                return `떡국${getKoreanParticle('떡국')} 설날에 먹는 전통 음식으로, ${tteokguk.meaning}입니다. ${tteokguk.ingredients.join(', ')} 등으로 만들어지며, ${tteokguk.details}`;
            }
            
            if (lowerQuestion.includes('송편')) {
                const songpyeon = sesiData.foods.송편;
                return `송편${getKoreanParticle('송편')} 추석에 빚는 전통 떡으로, ${songpyeon.meaning}입니다. ${songpyeon.ingredients.join(', ')} 등으로 만들어지며, ${songpyeon.details}`;
            }
            
            if (lowerQuestion.includes('팥죽')) {
                const patjuk = sesiData.foods.팥죽;
                return `팥죽${getKoreanParticle('팥죽')} 동지에 먹는 전통 음식으로, ${patjuk.meaning}입니다. ${patjuk.ingredients.join(', ')} 등으로 만들어지며, ${patjuk.details}`;
            }
            
            if (lowerQuestion.includes('부럼')) {
                const bureom = sesiData.foods.부럼;
                return `부럼${getKoreanParticle('부럼')} 정월대보름에 먹는 견과류로, ${bureom.meaning}입니다. ${bureom.ingredients.join(', ')} 등으로 구성되며, ${bureom.details}`;
            }
            
            if (lowerQuestion.includes('귀밝이술')) {
                const gwibalkiSul = sesiData.foods.귀밝이술;
                return `귀밝이술${getKoreanParticle('귀밝이술')} 정월대보름에 마시는 술로, ${gwibalkiSul.meaning}입니다. ${gwibalkiSul.ingredients.join(', ')} 등으로 만들어지며, ${gwibalkiSul.details}`;
            }
            
            if (lowerQuestion.includes('화전')) {
                const hwajeon = sesiData.foods.화전;
                return `화전${getKoreanParticle('화전')} 삼짇날에 먹는 떡으로, ${hwajeon.meaning}입니다. ${hwajeon.ingredients.join(', ')} 등으로 만들어지며, ${hwajeon.details}`;
            }
            
            if (lowerQuestion.includes('한과')) {
                const hangwa = sesiData.foods.한과;
                return `한과${getKoreanParticle('한과')} 전통 과자로, ${hangwa.meaning}입니다. ${hangwa.ingredients.join(', ')} 등으로 만들어지며, ${hangwa.details}`;
            }
            
            // 놀이 관련 질문
            if (lowerQuestion.includes('윷놀이')) {
                const yutnori = sesiData.games.윷놀이;
                return `윷놀이${getKoreanParticle('윷놀이')} ${yutnori.description}로, ${yutnori.meaning}입니다. ${yutnori.details}`;
            }
            
            if (lowerQuestion.includes('연날리기') && !(lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                const yeonnalligi = sesiData.games.연날리기;
                return `연날리기${getKoreanParticle('연날리기')} ${yeonnalligi.description}로, ${yeonnalligi.meaning}입니다. ${yeonnalligi.details}`;
            }
            
            if (lowerQuestion.includes('그네뛰기') && !(lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                const geuneTtwigi = sesiData.games.그네뛰기;
                return `그네뛰기${getKoreanParticle('그네뛰기')} ${geuneTtwigi.description}로, ${geuneTtwigi.meaning}입니다. ${geuneTtwigi.details}`;
            }
            
            if (lowerQuestion.includes('씨름') && !(lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                const ssireum = sesiData.games.씨름;
                return `씨름${getKoreanParticle('씨름')} ${ssireum.description}로, ${ssireum.meaning}입니다. ${ssireum.details}`;
            }
            
            if (lowerQuestion.includes('널뛰기') && !(lowerQuestion.includes('왜') || lowerQuestion.includes('이유'))) {
                const neolTtwigi = sesiData.games.널뛰기;
                return `널뛰기${getKoreanParticle('널뛰기')} ${neolTtwigi.description}로, ${neolTtwigi.meaning}입니다. ${neolTtwigi.details}`;
            }
            
            if (lowerQuestion.includes('제기차기')) {
                const jegichagi = sesiData.games.제기차기;
                return `제기차기${getKoreanParticle('제기차기')} ${jegichagi.description}로, ${jegichagi.meaning}입니다. ${jegichagi.details}`;
            }
            
            if (lowerQuestion.includes('팽이치기')) {
                const paengichigi = sesiData.games.팽이치기;
                return `팽이치기${getKoreanParticle('팽이치기')} ${paengichigi.description}로, ${paengichigi.meaning}입니다. ${paengichigi.details}`;
            }
            
            if (lowerQuestion.includes('활쏘기')) {
                const hwalssoogi = sesiData.games.활쏘기;
                return `활쏘기${getKoreanParticle('활쏘기')} ${hwalssoogi.description}로, ${hwalssoogi.meaning}입니다. ${hwalssoogi.details}`;
            }
            
            if (lowerQuestion.includes('줄다리기')) {
                const julDareugi = sesiData.games.줄다리기;
                return `줄다리기${getKoreanParticle('줄다리기')} ${julDareugi.description}로, ${julDareugi.meaning}입니다. ${julDareugi.details}`;
            }
            
            // 청도 지역 관련 질문
            if (lowerQuestion.includes('청도') || lowerQuestion.includes('경북')) {
                const cheongdo = sesiData.cheongdo;
                if (lowerQuestion.includes('달집태우기')) {
                    const event = cheongdo.specialFestivals.청도달집태우기;
                    return `청도달집태우기${getKoreanParticle('청도달집태우기')} ${event.date}에 청도읍성에서 열리는 ${event.description}입니다. ${event.participants}이 참여하여 ${event.meaning}입니다. ${event.details}`;
                }
                return `청도${getKoreanParticle('청도')} 경상북도에 위치한 전통문화가 풍부한 지역입니다. 특히 정월대보름에 전국 최대 규모의 달집태우기 행사가 열리며, 청도읍성과 대비사대웅전 등의 문화유산이 있습니다.`;
            }
            
            
            // 시각적 자료 관련 질문 (그림 그리기)
            if (lowerQuestion.includes('그림') || lowerQuestion.includes('그리기') || lowerQuestion.includes('그려')) {
                if (lowerQuestion.includes('달집태우기')) {
                    const visual = sesiData.visualMaterials.달집태우기;
                    return `달집태우기 그림을 그릴 때는 ${visual.elements.join(', ')} 등을 포함하고, ${visual.colors.join(', ')} 등의 색상을 사용하여 ${visual.mood}를 표현하면 됩니다.`;
                }
                if (lowerQuestion.includes('정월대보름')) {
                    const visual = sesiData.visualMaterials.정월대보름;
                    return `정월대보름 그림을 그릴 때는 ${visual.elements.join(', ')} 등을 포함하고, ${visual.colors.join(', ')} 등의 색상을 사용하여 ${visual.mood}를 표현하면 됩니다.`;
                }
                if (lowerQuestion.includes('윷놀이')) {
                    const visual = sesiData.visualMaterials.윷놀이;
                    return `윷놀이 그림을 그릴 때는 ${visual.elements.join(', ')} 등을 포함하고, ${visual.colors.join(', ')} 등의 색상을 사용하여 ${visual.mood}를 표현하면 됩니다.`;
                }
                if (lowerQuestion.includes('강강술래')) {
                    const visual = sesiData.visualMaterials.강강술래;
                    return `강강술래 그림을 그릴 때는 ${visual.elements.join(', ')} 등을 포함하고, ${visual.colors.join(', ')} 등을 사용하여 ${visual.mood}를 표현하면 됩니다.`;
                }
                if (lowerQuestion.includes('그네뛰기')) {
                    const visual = sesiData.visualMaterials.그네뛰기;
                    return `그네뛰기 그림을 그릴 때는 ${visual.elements.join(', ')} 등을 포함하고, ${visual.colors.join(', ')} 등을 사용하여 ${visual.mood}를 표현하면 됩니다.`;
                }
                if (lowerQuestion.includes('송편')) {
                    const visual = sesiData.visualMaterials.송편빚기;
                    return `송편빚기 그림을 그릴 때는 ${visual.elements.join(', ')} 등을 포함하고, ${visual.colors.join(', ')} 등을 사용하여 ${visual.mood}를 표현하면 됩니다.`;
                }
                if (lowerQuestion.includes('떡국')) {
                    const visual = sesiData.visualMaterials.떡국먹기;
                    return `떡국먹기 그림을 그릴 때는 ${visual.elements.join(', ')} 등을 포함하고, ${visual.colors.join(', ')} 등을 사용하여 ${visual.mood}를 표현하면 됩니다.`;
                }
                if (lowerQuestion.includes('연날리기')) {
                    const visual = sesiData.visualMaterials.연날리기;
                    return `연날리기 그림을 그릴 때는 ${visual.elements.join(', ')} 등을 포함하고, ${visual.colors.join(', ')} 등을 사용하여 ${visual.mood}를 표현하면 됩니다.`;
                }
                return '세시풍속 그림을 그릴 때는 전통적인 요소들(한복, 전통 음식, 전통 놀이 등)과 따뜻하고 화목한 색감을 사용하여 우리 전통문화의 아름다움을 표현하면 됩니다!';
            }
            
            // 학습되지 않은 세시풍속에 대한 실시간 검색 제공
            const searchLinks = generateRealTimeSearchLinks(question);
            
            // 질문 유형에 따른 맞춤 검색어 생성
            let customSearchTerms = [];
            if (questionTypes.includes('yesNo')) {
                customSearchTerms = [`"${question}"`, `"${question} 세시풍속"`, `"${question} 전통"`];
            } else if (questionTypes.includes('what')) {
                customSearchTerms = [`"${question}"`, `"${question} 의미"`, `"${question} 정의"`];
            } else if (questionTypes.includes('why')) {
                customSearchTerms = [`"${question}"`, `"${question} 이유"`, `"${question} 유래"`];
            } else if (questionTypes.includes('how')) {
                customSearchTerms = [`"${question}"`, `"${question} 방법"`, `"${question} 하는법"`];
            } else if (questionTypes.includes('when')) {
                customSearchTerms = [`"${question}"`, `"${question} 시기"`, `"${question} 언제"`];
            } else if (questionTypes.includes('where')) {
                customSearchTerms = [`"${question}"`, `"${question} 장소"`, `"${question} 어디"`];
            } else {
                customSearchTerms = [`"${question} 세시풍속"`, `"${question} 전통"`, `"${question} 의미"`];
            }
            
            return `죄송합니다. "${question}"에 대한 정보는 아직 학습되지 않았습니다.\n\n🔍 실시간 검색을 통해 찾아보세요:\n\n📱 구글: ${searchLinks.google}\n🇰🇷 네이버: ${searchLinks.naver}\n📷 네이버 이미지: ${searchLinks.naverImage}\n\n💡 추천 검색어: ${customSearchTerms.join(', ')}\n\n🎯 학습된 세시풍속 주제들:\n🌸 봄: 설날, 정월대보름, 삼짇날, 청명, 한식\n☀️ 여름: 단오, 유두, 칠석, 백중\n🍂 가을: 추석, 중양절, 상달\n❄️ 겨울: 동지, 섣달그믐\n\n🎮 전통놀이: 윷놀이, 강강술래, 그네뛰기, 씨름, 연날리기, 제기차기, 팽이치기, 널뛰기\n🍽️ 전통음식: 떡국, 송편, 오곡밥, 부럼, 귀밝이술, 화전, 수리취떡, 팥죽, 한과, 약과\n🎭 전통풍습: 지신밟기, 상달고사, 차례, 성묘\n\n📸 사진 자료도 검색 가능합니다!`;
        }

        // 관리자 데이터 관련 함수들
        function loadAdminData() {
            try {
                const saved = localStorage.getItem('adminData');
                if (saved) {
                    adminData = JSON.parse(saved);
                    // Set 객체 복원
                    adminData.users = new Set(adminData.users);
                }
                updateAdminStats();
            } catch (error) {
                console.error('❌ 관리자 데이터 로드 중 오류 발생:', error);
                // localStorage가 지원되지 않거나 오류가 발생한 경우 기본값 사용
                adminData = {
                    questions: [],
                    users: new Set(),
                    keywords: {},
                    categories: {}
                };
            }
        }

        function saveAdminData() {
            try {
                // Set 객체를 배열로 변환하여 저장
                const dataToSave = {
                    ...adminData,
                    users: Array.from(adminData.users)
                };
                localStorage.setItem('adminData', JSON.stringify(dataToSave));
            } catch (error) {
                console.error('❌ 관리자 데이터 저장 중 오류 발생:', error);
                // localStorage가 지원되지 않는 경우 무시
            }
        }

        function logQuestion(question, answer) {
            const questionData = {
                question: question,
                answer: answer,
                user: currentUser.nickname,
                timestamp: new Date().toISOString(),
                category: categorizeQuestion(question),
                keywords: extractKeywords(question)
            };
            
            adminData.questions.push(questionData);
            adminData.users.add(currentUser.nickname);
            
            // 키워드 통계 업데이트
            questionData.keywords.forEach(keyword => {
                adminData.keywords[keyword] = (adminData.keywords[keyword] || 0) + 1;
            });
            
            // 카테고리 통계 업데이트
            const category = questionData.category;
            adminData.categories[category] = (adminData.categories[category] || 0) + 1;
            
            saveAdminData();
            updateAdminStats();
        }

        function categorizeQuestion(question) {
            const lowerQuestion = question.toLowerCase();
            if (lowerQuestion.includes('설날')) return '설날';
            if (lowerQuestion.includes('단오')) return '단오';
            if (lowerQuestion.includes('추석')) return '추석';
            if (lowerQuestion.includes('강강술래')) return '전통놀이';
            if (lowerQuestion.includes('음식')) return '음식';
            if (lowerQuestion.includes('놀이')) return '놀이';
            return '기타';
        }

        function extractKeywords(question) {
            const keywords = [];
            const keywordMap = {
                '설날': ['설날', '새해', '떡국', '세배', '설빔', '복조리', '복주머니', '가래떡', '강정', '덕담', '세찬', '세주', '수정과', '세화', '문배', '야광귀', '청참', '제기차기', '팽이치기'],
                '정월대보름': ['정월대보름', '대보름', '달집태우기', '쥐불놀이', '다리밟기', '부럼', '오곡밥', '가수', '고싸움', '더위팔기', '약밥', '나물', '줄다리기', '지신밟기', '횃불싸움', '달맞이', '귀밝이술'],
                '단오': ['단오', '수릿날', '창포', '창포물', '창포비녀', '그네', '그네뛰기', '씨름', '수리취떡', '앵두화채', '부채', '단오빔', '대추나무시집보내기', '강릉단오제'],
                '추석': ['추석', '한가위', '송편', '강강술래', '강강수월래', '귀성', '성묘', '소놀이', '토란국', '추석빔', '길쌈놀이', '꼬리따기', '문지기놀이', '햇곡식', '햇과일'],
                '동지': ['동지', '아세', '팥죽', '동지팥죽', '팥죽뿌리기', '동지책력', '달력', '새알심'],
                '놀이': ['놀이', '윷놀이', '연날리기', '널뛰기', '제기차기', '팽이치기'],
                '음식': ['음식', '떡국', '송편', '전', '나물', '강정', '수정과'],
                '유래': ['유래', '기원', '어디서', '왜', '시작', '탄생', '역사'],
                '차례': ['차례', '차례상', '제사', '조상']
            };
            
            Object.entries(keywordMap).forEach(([category, words]) => {
                words.forEach(word => {
                    if (question.includes(word)) {
                        keywords.push(word);
                    }
                });
            });
            
            return [...new Set(keywords)]; // 중복 제거
        }

        function updateAdminStats() {
            const today = new Date().toDateString();
            const todayQuestions = adminData.questions.filter(q => 
                new Date(q.timestamp).toDateString() === today
            ).length;
            
            document.getElementById('totalQuestions').textContent = adminData.questions.length;
            document.getElementById('todayQuestions').textContent = todayQuestions;
            document.getElementById('activeUsers').textContent = adminData.users.size;
            document.getElementById('popularTopics').textContent = Object.keys(adminData.categories).length;
            
            updateQuestionLog();
            updatePopularQuestions();
            updateKeywordAnalysis();
        }

        function updateQuestionLog() {
            const logContainer = document.getElementById('questionLog');
            const recentQuestions = adminData.questions.slice(-10).reverse();
            
            if (recentQuestions.length === 0) {
                logContainer.innerHTML = '<div class="no-data">아직 질문이 없습니다.</div>';
                return;
            }
            
            logContainer.innerHTML = recentQuestions.map(q => `
                <div class="question-item">
                    <div class="question-user">${q.user}</div>
                    <div class="question-text">${q.question}</div>
                    <div class="question-time">${new Date(q.timestamp).toLocaleString()}</div>
                </div>
            `).join('');
        }

        function updatePopularQuestions() {
            const container = document.getElementById('popularQuestions');
            const questionCounts = {};
            
            adminData.questions.forEach(q => {
                questionCounts[q.question] = (questionCounts[q.question] || 0) + 1;
            });
            
            const popular = Object.entries(questionCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);
            
            if (popular.length === 0) {
                container.innerHTML = '<div class="no-data">아직 데이터가 없습니다.</div>';
                return;
            }
            
            container.innerHTML = popular.map(([question, count]) => `
                <div class="question-item">
                    <div class="question-text">${question}</div>
                    <div class="question-time">${count}회 질문</div>
                </div>
            `).join('');
        }

        function updateKeywordAnalysis() {
            const container = document.getElementById('keywordAnalysis');
            const keywords = Object.entries(adminData.keywords)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
            
            if (keywords.length === 0) {
                container.innerHTML = '<div class="no-data">아직 데이터가 없습니다.</div>';
                return;
            }
            
            container.innerHTML = keywords.map(([keyword, count]) => `
                <div class="question-item">
                    <div class="question-text">${keyword}</div>
                    <div class="question-time">${count}회 언급</div>
                </div>
            `).join('');
        }

        function exportData() {
            const dataStr = JSON.stringify(adminData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'admin_data.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        function clearOldData() {
            if (confirm('30일 이상 된 데이터를 삭제하시겠습니까?')) {
                const thirtyDaysAgo = new Date();
                thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
                
                adminData.questions = adminData.questions.filter(q => 
                    new Date(q.timestamp) > thirtyDaysAgo
                );
                
                saveAdminData();
                updateAdminStats();
                alert('오래된 데이터가 삭제되었습니다.');
            }
        }

        function clearAllQuestionHistory() {
            if (confirm('모든 질문 기록을 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.')) {
                // 모든 질문 기록 삭제
                adminData.questions = [];
                adminData.users = new Set();
                adminData.keywords = {};
                adminData.categories = {};
                
                // localStorage에서도 삭제
                try {
                    localStorage.removeItem('adminData');
                } catch (error) {
                    console.error('❌ 관리자 데이터 삭제 중 오류 발생:', error);
                }
                
                // UI 업데이트
                updateQuestionLog();
                updateAdminStats();
                
                alert('모든 질문 기록이 삭제되었습니다.');
            }
        }

        function refreshStats() {
            loadAdminData();
            alert('통계가 새로고침되었습니다.');
        }
    </script>


</body></html>